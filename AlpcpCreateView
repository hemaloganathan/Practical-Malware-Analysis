1: kd> uf AlpcpCreateView
nt!AlpcpCreateView:
fffff806`1a460aa4 4055            push    rbp
fffff806`1a460aa6 53              push    rbx
fffff806`1a460aa7 56              push    rsi
fffff806`1a460aa8 57              push    rdi
fffff806`1a460aa9 4154            push    r12
fffff806`1a460aab 4155            push    r13
fffff806`1a460aad 4156            push    r14
fffff806`1a460aaf 4157            push    r15
fffff806`1a460ab1 488bec          mov     rbp,rsp
fffff806`1a460ab4 4883ec68        sub     rsp,68h
fffff806`1a460ab8 4c8b7110        mov     r14,qword ptr [rcx+10h]
fffff806`1a460abc 488bf9          mov     rdi,rcx
fffff806`1a460abf 33db            xor     ebx,ebx
fffff806`1a460ac1 498bce          mov     rcx,r14
fffff806`1a460ac4 4d8be0          mov     r12,r8
fffff806`1a460ac7 498918          mov     qword ptr [r8],rbx
fffff806`1a460aca 4c8bfa          mov     r15,rdx
fffff806`1a460acd e8faefffff      call    nt!AlpcpLockForCachedReferenceBlob (fffff806`1a45facc)
fffff806`1a460ad2 418b87a0010000  mov     eax,dword ptr [r15+1A0h]
fffff806`1a460ad9 a820            test    al,20h
fffff806`1a460adb 0f85d7931c00    jne     nt!AlpcpCreateView+0x1c9414 (fffff806`1a629eb8)  Branch

nt!AlpcpCreateView+0x3d:
fffff806`1a460ae1 498b8730010000  mov     rax,qword ptr [r15+130h]
fffff806`1a460ae8 4d8b6f18        mov     r13,qword ptr [r15+18h]
fffff806`1a460aec 4885c0          test    rax,rax
fffff806`1a460aef 740a            je      nt!AlpcpCreateView+0x57 (fffff806`1a460afb)  Branch

nt!AlpcpCreateView+0x4d:
fffff806`1a460af1 483b4728        cmp     rax,qword ptr [rdi+28h]
fffff806`1a460af5 0f82c7931c00    jb      nt!AlpcpCreateView+0x1c941e (fffff806`1a629ec2)  Branch

nt!AlpcpCreateView+0x57:
fffff806`1a460afb 8b4730          mov     eax,dword ptr [rdi+30h]
fffff806`1a460afe a801            test    al,1
fffff806`1a460b00 7414            je      nt!AlpcpCreateView+0x72 (fffff806`1a460b16)  Branch

nt!AlpcpCreateView+0x5e:
fffff806`1a460b02 837f3402        cmp     dword ptr [rdi+34h],2
fffff806`1a460b06 0f83c0931c00    jae     nt!AlpcpCreateView+0x1c9428 (fffff806`1a629ecc)  Branch

nt!AlpcpCreateView+0x68:
fffff806`1a460b0c 48395f50        cmp     qword ptr [rdi+50h],rbx
fffff806`1a460b10 0f85b6931c00    jne     nt!AlpcpCreateView+0x1c9428 (fffff806`1a629ecc)  Branch

nt!AlpcpCreateView+0x72:
fffff806`1a460b16 4533c0          xor     r8d,r8d
fffff806`1a460b19 488d0d1829daff  lea     rcx,[nt!AlpcViewType (fffff806`1a203438)]
fffff806`1a460b20 418d5060        lea     edx,[r8+60h]
fffff806`1a460b24 e8d3060000      call    nt!AlpcpAllocateBlob (fffff806`1a4611fc)
fffff806`1a460b29 488bf0          mov     rsi,rax
fffff806`1a460b2c 4885c0          test    rax,rax
fffff806`1a460b2f 0f84a1931c00    je      nt!AlpcpCreateView+0x1c9432 (fffff806`1a629ed6)  Branch

nt!AlpcpCreateView+0x91:
fffff806`1a460b35 33d2            xor     edx,edx
fffff806`1a460b37 488bc8          mov     rcx,rax
fffff806`1a460b3a 448d4260        lea     r8d,[rdx+60h]
fffff806`1a460b3e e83da4c1ff      call    nt!memset (fffff806`1a07af80)
fffff806`1a460b43 488b4718        mov     rax,qword ptr [rdi+18h]
fffff806`1a460b47 4c8d4550        lea     r8,[rbp+50h]
fffff806`1a460b4b 48894560        mov     qword ptr [rbp+60h],rax
fffff806`1a460b4f 488b4728        mov     rax,qword ptr [rdi+28h]
fffff806`1a460b53 48894558        mov     qword ptr [rbp+58h],rax
fffff806`1a460b57 418b8700010000  mov     eax,dword ptr [r15+100h]
fffff806`1a460b5e 2500001000      and     eax,100000h
fffff806`1a460b63 48895d50        mov     qword ptr [rbp+50h],rbx
fffff806`1a460b67 894548          mov     dword ptr [rbp+48h],eax
fffff806`1a460b6a 0f8570931c00    jne     nt!AlpcpCreateView+0x1c943c (fffff806`1a629ee0)  Branch

nt!AlpcpCreateView+0xcc:
fffff806`1a460b70 418b4630        mov     eax,dword ptr [r14+30h]
fffff806`1a460b74 498bd5          mov     rdx,r13
fffff806`1a460b77 a802            test    al,2
fffff806`1a460b79 0f8425010000    je      nt!AlpcpCreateView+0x200 (fffff806`1a460ca4)  Branch

nt!AlpcpCreateView+0xdb:
fffff806`1a460b7f 498b0e          mov     rcx,qword ptr [r14]
fffff806`1a460b82 488d4638        lea     rax,[rsi+38h]
fffff806`1a460b86 4889442458      mov     qword ptr [rsp+58h],rax
fffff806`1a460b8b 488d4558        lea     rax,[rbp+58h]
fffff806`1a460b8f 4889442430      mov     qword ptr [rsp+30h],rax
fffff806`1a460b94 488d4560        lea     rax,[rbp+60h]
fffff806`1a460b98 4889442428      mov     qword ptr [rsp+28h],rax
fffff806`1a460b9d e832070000      call    nt!MmMapSecureViewOfSection (fffff806`1a4612d4)

nt!AlpcpCreateView+0xfe:
fffff806`1a460ba2 8bd8            mov     ebx,eax
fffff806`1a460ba4 85c0            test    eax,eax
fffff806`1a460ba6 0f8860931c00    js      nt!AlpcpCreateView+0x1c9468 (fffff806`1a629f0c)  Branch

nt!AlpcpCreateView+0x108:
fffff806`1a460bac 488b4550        mov     rax,qword ptr [rbp+50h]
fffff806`1a460bb0 ba416c7063      mov     edx,63706C41h
fffff806`1a460bb5 48894628        mov     qword ptr [rsi+28h],rax
fffff806`1a460bb9 488b4558        mov     rax,qword ptr [rbp+58h]
fffff806`1a460bbd 48894630        mov     qword ptr [rsi+30h],rax
fffff806`1a460bc1 33c0            xor     eax,eax
fffff806`1a460bc3 2b4548          sub     eax,dword ptr [rbp+48h]
fffff806`1a460bc6 f7d8            neg     eax
fffff806`1a460bc8 8b4648          mov     eax,dword ptr [rsi+48h]
fffff806`1a460bcb 1bc9            sbb     ecx,ecx
fffff806`1a460bcd 83e0f7          and     eax,0FFFFFFF7h
fffff806`1a460bd0 83e108          and     ecx,8
fffff806`1a460bd3 0bc8            or      ecx,eax
fffff806`1a460bd5 83c901          or      ecx,1
fffff806`1a460bd8 894e48          mov     dword ptr [rsi+48h],ecx
fffff806`1a460bdb 498bcd          mov     rcx,r13
fffff806`1a460bde e86dedb2ff      call    nt!ObfReferenceObjectWithTag (fffff806`19f8f950)
fffff806`1a460be3 498bcf          mov     rcx,r15
fffff806`1a460be6 4c896e20        mov     qword ptr [rsi+20h],r13
fffff806`1a460bea e8a151b6ff      call    nt!ObfReferenceObject (fffff806`19fc5d90)
fffff806`1a460bef 488bcf          mov     rcx,rdi
fffff806`1a460bf2 4c897e18        mov     qword ptr [rsi+18h],r15
fffff806`1a460bf6 e88d050000      call    nt!AlpcpReferenceBlob (fffff806`1a461188)
fffff806`1a460bfb 48897e10        mov     qword ptr [rsi+10h],rdi
fffff806`1a460bff 488d4f38        lea     rcx,[rdi+38h]
fffff806`1a460c03 488b4108        mov     rax,qword ptr [rcx+8]
fffff806`1a460c07 488bd6          mov     rdx,rsi
fffff806`1a460c0a 48890e          mov     qword ptr [rsi],rcx
fffff806`1a460c0d 48894608        mov     qword ptr [rsi+8],rax
fffff806`1a460c11 488b4108        mov     rax,qword ptr [rcx+8]
fffff806`1a460c15 488930          mov     qword ptr [rax],rsi
fffff806`1a460c18 48897108        mov     qword ptr [rcx+8],rsi
fffff806`1a460c1c 498bcf          mov     rcx,r15
fffff806`1a460c1f ff4734          inc     dword ptr [rdi+34h]
fffff806`1a460c22 e8d1000000      call    nt!AlpcpInsertResourcePort (fffff806`1a460cf8)
fffff806`1a460c27 498d9d50060000  lea     rbx,[r13+650h]
fffff806`1a460c2e 33d2            xor     edx,edx
fffff806`1a460c30 488bcb          mov     rcx,rbx
fffff806`1a460c33 e8a85bb6ff      call    nt!ExAcquirePushLockExclusiveEx (fffff806`19fc67e0)
fffff806`1a460c38 498d8d58060000  lea     rcx,[r13+658h]
fffff806`1a460c3f 488b4108        mov     rax,qword ptr [rcx+8]
fffff806`1a460c43 488d5650        lea     rdx,[rsi+50h]
fffff806`1a460c47 48894208        mov     qword ptr [rdx+8],rax
fffff806`1a460c4b 48890a          mov     qword ptr [rdx],rcx
fffff806`1a460c4e 488b4108        mov     rax,qword ptr [rcx+8]
fffff806`1a460c52 488910          mov     qword ptr [rax],rdx
fffff806`1a460c55 4883c8ff        or      rax,0FFFFFFFFFFFFFFFFh
fffff806`1a460c59 48895108        mov     qword ptr [rcx+8],rdx
fffff806`1a460c5d f0480fc103      lock xadd qword ptr [rbx],rax
fffff806`1a460c62 2406            and     al,6
fffff806`1a460c64 3c02            cmp     al,2
fffff806`1a460c66 747b            je      nt!AlpcpCreateView+0x23f (fffff806`1a460ce3)  Branch

nt!AlpcpCreateView+0x1c4:
fffff806`1a460c68 488bcb          mov     rcx,rbx
fffff806`1a460c6b e8c086b6ff      call    nt!KeAbPostRelease (fffff806`19fc9330)
fffff806`1a460c70 8b4730          mov     eax,dword ptr [rdi+30h]
fffff806`1a460c73 a801            test    al,1
fffff806`1a460c75 7404            je      nt!AlpcpCreateView+0x1d7 (fffff806`1a460c7b)  Branch

nt!AlpcpCreateView+0x1d3:
fffff806`1a460c77 48897750        mov     qword ptr [rdi+50h],rsi

nt!AlpcpCreateView+0x1d7:
fffff806`1a460c7b 488bce          mov     rcx,rsi
fffff806`1a460c7e e805050000      call    nt!AlpcpReferenceBlob (fffff806`1a461188)
fffff806`1a460c83 33db            xor     ebx,ebx
fffff806`1a460c85 49893424        mov     qword ptr [r12],rsi

nt!AlpcpCreateView+0x1e5:
fffff806`1a460c89 498bce          mov     rcx,r14
fffff806`1a460c8c e86f240e00      call    nt!AlpcpUnlockBlob (fffff806`1a543100)
fffff806`1a460c91 8bc3            mov     eax,ebx
fffff806`1a460c93 4883c468        add     rsp,68h
fffff806`1a460c97 415f            pop     r15
fffff806`1a460c99 415e            pop     r14
fffff806`1a460c9b 415d            pop     r13
fffff806`1a460c9d 415c            pop     r12
fffff806`1a460c9f 5f              pop     rdi
fffff806`1a460ca0 5e              pop     rsi
fffff806`1a460ca1 5b              pop     rbx
fffff806`1a460ca2 5d              pop     rbp
fffff806`1a460ca3 c3              ret

nt!AlpcpCreateView+0x200:
fffff806`1a460ca4 488b4f10        mov     rcx,qword ptr [rdi+10h]
fffff806`1a460ca8 488d4558        lea     rax,[rbp+58h]
fffff806`1a460cac c744244804000000 mov     dword ptr [rsp+48h],4
fffff806`1a460cb4 4533c9          xor     r9d,r9d
fffff806`1a460cb7 895c2440        mov     dword ptr [rsp+40h],ebx
fffff806`1a460cbb c744243802000000 mov     dword ptr [rsp+38h],2
fffff806`1a460cc3 488b09          mov     rcx,qword ptr [rcx]
fffff806`1a460cc6 4889442430      mov     qword ptr [rsp+30h],rax
fffff806`1a460ccb 488d4560        lea     rax,[rbp+60h]
fffff806`1a460ccf 4889442428      mov     qword ptr [rsp+28h],rax
fffff806`1a460cd4 48895c2420      mov     qword ptr [rsp+20h],rbx
fffff806`1a460cd9 e8c27c0300      call    nt!MmMapViewOfSection (fffff806`1a4989a0)
fffff806`1a460cde e9bffeffff      jmp     nt!AlpcpCreateView+0xfe (fffff806`1a460ba2)  Branch

nt!AlpcpCreateView+0x23f:
fffff806`1a460ce3 488bcb          mov     rcx,rbx
fffff806`1a460ce6 e85574a6ff      call    nt!ExfTryToWakePushLock (fffff806`19ec8140)
fffff806`1a460ceb e978ffffff      jmp     nt!AlpcpCreateView+0x1c4 (fffff806`1a460c68)  Branch

nt!AlpcpCreateView+0x1c9414:
fffff806`1a629eb8 bb370000c0      mov     ebx,0C0000037h
fffff806`1a629ebd e9c76de3ff      jmp     nt!AlpcpCreateView+0x1e5 (fffff806`1a460c89)  Branch

nt!AlpcpCreateView+0x1c941e:
fffff806`1a629ec2 bb440000c0      mov     ebx,0C0000044h
fffff806`1a629ec7 e9bd6de3ff      jmp     nt!AlpcpCreateView+0x1e5 (fffff806`1a460c89)  Branch

nt!AlpcpCreateView+0x1c9428:
fffff806`1a629ecc bb220000c0      mov     ebx,0C0000022h
fffff806`1a629ed1 e9b36de3ff      jmp     nt!AlpcpCreateView+0x1e5 (fffff806`1a460c89)  Branch

nt!AlpcpCreateView+0x1c9432:
fffff806`1a629ed6 bb9a0000c0      mov     ebx,0C000009Ah
fffff806`1a629edb e9a96de3ff      jmp     nt!AlpcpCreateView+0x1e5 (fffff806`1a460c89)  Branch

nt!AlpcpCreateView+0x1c943c:
fffff806`1a629ee0 498b0e          mov     rcx,qword ptr [r14]
fffff806`1a629ee3 488d4560        lea     rax,[rbp+60h]
fffff806`1a629ee7 48895c2430      mov     qword ptr [rsp+30h],rbx
fffff806`1a629eec 4c8d4d58        lea     r9,[rbp+58h]
fffff806`1a629ef0 48895c2428      mov     qword ptr [rsp+28h],rbx
fffff806`1a629ef5 488d15c44fccff  lea     rdx,[nt!MiState+0x500 (fffff806`1a2eeec0)]
fffff806`1a629efc 4889442420      mov     qword ptr [rsp+20h],rax
fffff806`1a629f01 e876a5efff      call    nt!MiMapViewInSystemSpace (fffff806`1a52447c)
fffff806`1a629f06 90              nop
fffff806`1a629f07 e9966ce3ff      jmp     nt!AlpcpCreateView+0xfe (fffff806`1a460ba2)  Branch

nt!AlpcpCreateView+0x1c9468:
fffff806`1a629f0c ba01000000      mov     edx,1
fffff806`1a629f11 488bce          mov     rcx,rsi
fffff806`1a629f14 e83b66e3ff      call    nt!AlpcpDereferenceBlobEx (fffff806`1a460554)
fffff806`1a629f19 90              nop
fffff806`1a629f1a e96a6de3ff      jmp     nt!AlpcpCreateView+0x1e5 (fffff806`1a460c89)  Branch
