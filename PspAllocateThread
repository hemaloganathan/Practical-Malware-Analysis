lkd> uf PspAllocateThread
nt!PspAllocateThread:
fffff806`192a386c 4488442418      mov     byte ptr [rsp+18h],r8b
fffff806`192a3871 53              push    rbx
fffff806`192a3872 56              push    rsi
fffff806`192a3873 57              push    rdi
fffff806`192a3874 4154            push    r12
fffff806`192a3876 4155            push    r13
fffff806`192a3878 4156            push    r14
fffff806`192a387a 4157            push    r15
fffff806`192a387c 4881ec50010000  sub     rsp,150h
fffff806`192a3883 488b051644e0ff  mov     rax,qword ptr [nt!_security_cookie (fffff806`190a7ca0)]
fffff806`192a388a 4833c4          xor     rax,rsp
fffff806`192a388d 4889842448010000 mov     qword ptr [rsp+148h],rax
fffff806`192a3895 4d8be9          mov     r13,r9
fffff806`192a3898 458ad0          mov     r10b,r8b
fffff806`192a389b 488bf2          mov     rsi,rdx
fffff806`192a389e 4c8bf9          mov     r15,rcx
fffff806`192a38a1 48898c24b8000000 mov     qword ptr [rsp+0B8h],rcx
fffff806`192a38a9 4889542478      mov     qword ptr [rsp+78h],rdx
fffff806`192a38ae 4c898c24c0000000 mov     qword ptr [rsp+0C0h],r9
fffff806`192a38b6 4c8b8424b0010000 mov     r8,qword ptr [rsp+1B0h]
fffff806`192a38be 4c89842480000000 mov     qword ptr [rsp+80h],r8
fffff806`192a38c6 4c8b8c24b8010000 mov     r9,qword ptr [rsp+1B8h]
fffff806`192a38ce 4c898c2490000000 mov     qword ptr [rsp+90h],r9
fffff806`192a38d6 488b8424d8010000 mov     rax,qword ptr [rsp+1D8h]
fffff806`192a38de 48898424f0000000 mov     qword ptr [rsp+0F0h],rax
fffff806`192a38e6 488b9424e0010000 mov     rdx,qword ptr [rsp+1E0h]
fffff806`192a38ee 4889942488000000 mov     qword ptr [rsp+88h],rdx
fffff806`192a38f6 4c8bb424e8010000 mov     r14,qword ptr [rsp+1E8h]
fffff806`192a38fe 33ff            xor     edi,edi
fffff806`192a3900 4889bc2498000000 mov     qword ptr [rsp+98h],rdi
fffff806`192a3908 654c8b1c2588010000 mov   r11,qword ptr gs:[188h]
fffff806`192a3911 4c899c24b0000000 mov     qword ptr [rsp+0B0h],r11
fffff806`192a3919 448be7          mov     r12d,edi
fffff806`192a391c 897c2458        mov     dword ptr [rsp+58h],edi
fffff806`192a3920 4d85c9          test    r9,r9
fffff806`192a3923 0f8405441900    je      nt!PspAllocateThread+0x1944c2 (fffff806`19437d2e)  Branch

nt!PspAllocateThread+0xbd:
fffff806`192a3929 498b01          mov     rax,qword ptr [r9]

nt!PspAllocateThread+0xc0:
fffff806`192a392c 48898424a0000000 mov     qword ptr [rsp+0A0h],rax
fffff806`192a3934 4889442460      mov     qword ptr [rsp+60h],rax
fffff806`192a3939 4d85ed          test    r13,r13
fffff806`192a393c 7451            je      nt!PspAllocateThread+0x123 (fffff806`192a398f)  Branch

nt!PspAllocateThread+0xd2:
fffff806`192a393e 488bd7          mov     rdx,rdi
fffff806`192a3941 458b4d04        mov     r9d,dword ptr [r13+4]
fffff806`192a3945 418bc9          mov     ecx,r9d
fffff806`192a3948 81e100100000    and     ecx,1000h
fffff806`192a394e 498d8540010000  lea     rax,[r13+140h]
fffff806`192a3955 f7d9            neg     ecx
fffff806`192a3957 481bdb          sbb     rbx,rbx
fffff806`192a395a 4823d8          and     rbx,rax
fffff806`192a395d 488d0d9c26a0ff  lea     rcx,[nt!MmFreeIndependentPages <PERF> (nt+0x0) (fffff806`18ca6000)]
fffff806`192a3964 410fbae10e      bt      r9d,0Eh
fffff806`192a3969 0f82d4060000    jb      nt!PspAllocateThread+0x7d7 (fffff806`192a4043)  Branch

nt!PspAllocateThread+0x103:
fffff806`192a396f 4885d2          test    rdx,rdx
fffff806`192a3972 0f85df060000    jne     nt!PspAllocateThread+0x7eb (fffff806`192a4057)  Branch

nt!PspAllocateThread+0x10c:
fffff806`192a3978 4885db          test    rbx,rbx
fffff806`192a397b 0f8569060000    jne     nt!PspAllocateThread+0x77e (fffff806`192a3fea)  Branch

nt!PspAllocateThread+0x115:
fffff806`192a3981 41f7450400800000 test    dword ptr [r13+4],8000h
fffff806`192a3989 0f85e2431900    jne     nt!PspAllocateThread+0x194505 (fffff806`19437d71)  Branch

nt!PspAllocateThread+0x123:
fffff806`192a398f 4189be80010000  mov     dword ptr [r14+180h],edi
fffff806`192a3996 45889684010000  mov     byte ptr [r14+184h],r10b
fffff806`192a399d 4d85c0          test    r8,r8
fffff806`192a39a0 0f843f050000    je      nt!PspAllocateThread+0x679 (fffff806`192a3ee5)  Branch

nt!PspAllocateThread+0x13a:
fffff806`192a39a6 4c3b3d3319f4ff  cmp     r15,qword ptr [nt!PsInitialSystemProcess (fffff806`191e52e0)]
fffff806`192a39ad 0f84d4431900    je      nt!PspAllocateThread+0x19451b (fffff806`19437d87)  Branch

nt!PspAllocateThread+0x147:
fffff806`192a39b3 4885f6          test    rsi,rsi
fffff806`192a39b6 0f8489000000    je      nt!PspAllocateThread+0x1d9 (fffff806`192a3a45)  Branch

nt!PspAllocateThread+0x150:
fffff806`192a39bc 4180fa01        cmp     r10b,1
fffff806`192a39c0 7524            jne     nt!PspAllocateThread+0x17a (fffff806`192a39e6)  Branch

nt!PspAllocateThread+0x156:
fffff806`192a39c2 40f6c603        test    sil,3
fffff806`192a39c6 7518            jne     nt!PspAllocateThread+0x174 (fffff806`192a39e0)  Branch

nt!PspAllocateThread+0x15c:
fffff806`192a39c8 488bc6          mov     rax,rsi
fffff806`192a39cb 48b90000ffffff7f0000 mov rcx,7FFFFFFF0000h
fffff806`192a39d5 483bf1          cmp     rsi,rcx
fffff806`192a39d8 480f43c1        cmovae  rax,rcx
fffff806`192a39dc 8a00            mov     al,byte ptr [rax]
fffff806`192a39de eb06            jmp     nt!PspAllocateThread+0x17a (fffff806`192a39e6)  Branch

nt!PspAllocateThread+0x174:
fffff806`192a39e0 e8eb7e2d00      call    nt!ExRaiseDatatypeMisalignment (fffff806`1957b8d0)
fffff806`192a39e5 cc              int     3

nt!PspAllocateThread+0x17a:
fffff806`192a39e6 418ac2          mov     al,r10b
fffff806`192a39e9 f6d8            neg     al
fffff806`192a39eb 1bc9            sbb     ecx,ecx
fffff806`192a39ed 81e100fefeff    and     ecx,0FFFEFE00h
fffff806`192a39f3 81c1f21f0100    add     ecx,11FF2h
fffff806`192a39f9 234e18          and     ecx,dword ptr [rsi+18h]
fffff806`192a39fc 41898e80010000  mov     dword ptr [r14+180h],ecx
fffff806`192a3a03 448bf7          mov     r14d,edi
fffff806`192a3a06 897c2450        mov     dword ptr [rsp+50h],edi
fffff806`192a3a0a eb30            jmp     nt!PspAllocateThread+0x1d0 (fffff806`192a3a3c)  Branch

nt!PspAllocateThread+0x1d0:
fffff806`192a3a3c 4585f6          test    r14d,r14d
fffff806`192a3a3f 0f8848431900    js      nt!PspAllocateThread+0x194521 (fffff806`19437d8d)  Branch

nt!PspAllocateThread+0x1d9:
fffff806`192a3a45 e8b68fa4ff      call    nt!PoEnergyEstimationEnabled (fffff806`18ceca00)
fffff806`192a3a4a 88442454        mov     byte ptr [rsp+54h],al
fffff806`192a3a4e 8ac8            mov     cl,al
fffff806`192a3a50 f6d9            neg     cl
fffff806`192a3a52 1bdb            sbb     ebx,ebx
fffff806`192a3a54 81e3c8000000    and     ebx,0C8h
fffff806`192a3a5a 81c310080000    add     ebx,810h
fffff806`192a3a60 e8bb64a6ff      call    nt!KeQueryMaximumGroupCount (fffff806`18d09f20)
fffff806`192a3a65 0fb7c8          movzx   ecx,ax
fffff806`192a3a68 897c2478        mov     dword ptr [rsp+78h],edi
fffff806`192a3a6c 83f901          cmp     ecx,1
fffff806`192a3a6f 0f872d060000    ja      nt!PspAllocateThread+0x836 (fffff806`192a40a2)  Branch

nt!PspAllocateThread+0x209:
fffff806`192a3a75 488b157c18f4ff  mov     rdx,qword ptr [nt!PsThreadType (fffff806`191e52f8)]
fffff806`192a3a7c 48897c2448      mov     qword ptr [rsp+48h],rdi
fffff806`192a3a81 488d442468      lea     rax,[rsp+68h]
fffff806`192a3a86 4889442440      mov     qword ptr [rsp+40h],rax
fffff806`192a3a8b 895c2438        mov     dword ptr [rsp+38h],ebx
fffff806`192a3a8f 897c2430        mov     dword ptr [rsp+30h],edi
fffff806`192a3a93 895c2428        mov     dword ptr [rsp+28h],ebx
fffff806`192a3a97 448a8c24a0010000 mov     r9b,byte ptr [rsp+1A0h]
fffff806`192a3a9f 4c8bc6          mov     r8,rsi
fffff806`192a3aa2 418ac9          mov     cl,r9b
fffff806`192a3aa5 e8c6fefbff      call    nt!ObCreateObjectEx (fffff806`19263970)
fffff806`192a3aaa 448bf0          mov     r14d,eax
fffff806`192a3aad 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3ab1 85c0            test    eax,eax
fffff806`192a3ab3 0f88d4421900    js      nt!PspAllocateThread+0x194521 (fffff806`19437d8d)  Branch

nt!PspAllocateThread+0x24d:
fffff806`192a3ab9 448bc3          mov     r8d,ebx
fffff806`192a3abc 33d2            xor     edx,edx
fffff806`192a3abe 488b742468      mov     rsi,qword ptr [rsp+68h]
fffff806`192a3ac3 488bce          mov     rcx,rsi
fffff806`192a3ac6 e835c5bcff      call    nt!memset (fffff806`18e70000)
fffff806`192a3acb 40387c2454      cmp     byte ptr [rsp+54h],dil
fffff806`192a3ad0 741d            je      nt!PspAllocateThread+0x283 (fffff806`192a3aef)  Branch

nt!PspAllocateThread+0x266:
fffff806`192a3ad2 488d8610080000  lea     rax,[rsi+810h]
fffff806`192a3ad9 488986b0070000  mov     qword ptr [rsi+7B0h],rax
fffff806`192a3ae0 f00fba2e15      lock bts dword ptr [rsi],15h
fffff806`192a3ae5 448b742450      mov     r14d,dword ptr [rsp+50h]
fffff806`192a3aea 488b742468      mov     rsi,qword ptr [rsp+68h]

nt!PspAllocateThread+0x283:
fffff806`192a3aef e81864a6ff      call    nt!KeSchedulerAssistThreadFlagEnabled (fffff806`18d09f0c)
fffff806`192a3af4 85c0            test    eax,eax
fffff806`192a3af6 0f85bd421900    jne     nt!PspAllocateThread+0x19454d (fffff806`19437db9)  Branch

nt!PspAllocateThread+0x290:
fffff806`192a3afc 8b442478        mov     eax,dword ptr [rsp+78h]
fffff806`192a3b00 85c0            test    eax,eax
fffff806`192a3b02 0f85ac050000    jne     nt!PspAllocateThread+0x848 (fffff806`192a40b4)  Branch

nt!PspAllocateThread+0x29c:
fffff806`192a3b08 488d8eb8060000  lea     rcx,[rsi+6B8h]
fffff806`192a3b0f e8ec63a6ff      call    nt!ExInitializePushLock (fffff806`18d09f00)
fffff806`192a3b14 488d8e38060000  lea     rcx,[rsi+638h]
fffff806`192a3b1b 48894c2478      mov     qword ptr [rsp+78h],rcx
fffff806`192a3b20 498b87e0020000  mov     rax,qword ptr [r15+2E0h]
fffff806`192a3b27 488901          mov     qword ptr [rcx],rax
fffff806`192a3b2a 488b8424d0010000 mov     rax,qword ptr [rsp+1D0h]
fffff806`192a3b32 8b00            mov     eax,dword ptr [rax]
fffff806`192a3b34 a804            test    al,4
fffff806`192a3b36 0f8591421900    jne     nt!PspAllocateThread+0x194561 (fffff806`19437dcd)  Branch

nt!PspAllocateThread+0x2d0:
fffff806`192a3b3c 488d9ec0060000  lea     rbx,[rsi+6C0h]
fffff806`192a3b43 48899c24d8000000 mov     qword ptr [rsp+0D8h],rbx
fffff806`192a3b4b 48893b          mov     qword ptr [rbx],rdi
fffff806`192a3b4e c786c806000007000000 mov dword ptr [rsi+6C8h],7
fffff806`192a3b58 488d8e48060000  lea     rcx,[rsi+648h]
fffff806`192a3b5f 33d2            xor     edx,edx
fffff806`192a3b61 448d4201        lea     r8d,[rdx+1]
fffff806`192a3b65 e87663a6ff      call    nt!KeInitializeSemaphore (fffff806`18d09ee0)
fffff806`192a3b6a 488d86f8050000  lea     rax,[rsi+5F8h]
fffff806`192a3b71 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3b75 488900          mov     qword ptr [rax],rax
fffff806`192a3b78 488d8618070000  lea     rax,[rsi+718h]
fffff806`192a3b7f 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3b83 488900          mov     qword ptr [rax],rax
fffff806`192a3b86 488d8628070000  lea     rax,[rsi+728h]
fffff806`192a3b8d 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3b91 488900          mov     qword ptr [rax],rax
fffff806`192a3b94 4889be38070000  mov     qword ptr [rsi+738h],rdi
fffff806`192a3b9b 488d8680070000  lea     rax,[rsi+780h]
fffff806`192a3ba2 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3ba6 488900          mov     qword ptr [rax],rax
fffff806`192a3ba9 48897810        mov     qword ptr [rax+10h],rdi
fffff806`192a3bad 488d8670060000  lea     rax,[rsi+670h]
fffff806`192a3bb4 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3bb8 488900          mov     qword ptr [rax],rax
fffff806`192a3bbb 4889be40070000  mov     qword ptr [rsi+740h],rdi
fffff806`192a3bc2 4889be20060000  mov     qword ptr [rsi+620h],rdi
fffff806`192a3bc9 488d8628060000  lea     rax,[rsi+628h]
fffff806`192a3bd0 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3bd4 488900          mov     qword ptr [rax],rax
fffff806`192a3bd7 48c786c8070000fdffffff mov qword ptr [rsi+7C8h],0FFFFFFFFFFFFFFFDh
fffff806`192a3be2 e8dd62a6ff      call    nt!KeQuerySystemTimeUnsafe (fffff806`18d09ec4)
fffff806`192a3be7 4885c0          test    rax,rax
fffff806`192a3bea 0f84db040000    je      nt!PspAllocateThread+0x85f (fffff806`192a40cb)  Branch

nt!PspAllocateThread+0x384:
fffff806`192a3bf0 488d8ef0050000  lea     rcx,[rsi+5F0h]
fffff806`192a3bf7 e8f463a6ff      call    nt!KeQuerySystemTimePrecise (fffff806`18d09ff0)

nt!PspAllocateThread+0x390:
fffff806`192a3bfc 488d86e8070000  lea     rax,[rsi+7E8h]
fffff806`192a3c03 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3c07 488900          mov     qword ptr [rax],rax
fffff806`192a3c0a 4889bef8070000  mov     qword ptr [rsi+7F8h],rdi
fffff806`192a3c11 488d8600080000  lea     rax,[rsi+800h]
fffff806`192a3c18 48894008        mov     qword ptr [rax+8],rax
fffff806`192a3c1c 488900          mov     qword ptr [rax],rax
fffff806`192a3c1f 33d2            xor     edx,edx
fffff806`192a3c21 488bcb          mov     rcx,rbx
fffff806`192a3c24 e8b772a7ff      call    nt!ExAcquirePushLockExclusiveEx (fffff806`18d1aee0)
fffff806`192a3c29 488b0d3018f4ff  mov     rcx,qword ptr [nt!PspCidTable (fffff806`191e5460)]
fffff806`192a3c30 48897c2420      mov     qword ptr [rsp+20h],rdi
fffff806`192a3c35 4533c9          xor     r9d,r9d
fffff806`192a3c38 4533c0          xor     r8d,r8d
fffff806`192a3c3b 488bd6          mov     rdx,rsi
fffff806`192a3c3e e88d93fdff      call    nt!ExCreateHandleEx (fffff806`1927cfd0)
fffff806`192a3c43 48898640060000  mov     qword ptr [rsi+640h],rax
fffff806`192a3c4a 4885c0          test    rax,rax
fffff806`192a3c4d 0f8486411900    je      nt!PspAllocateThread+0x19456d (fffff806`19437dd9)  Branch

nt!PspAllocateThread+0x3e7:
fffff806`192a3c53 488b9c2480000000 mov     rbx,qword ptr [rsp+80h]
fffff806`192a3c5b 4885db          test    rbx,rbx
fffff806`192a3c5e 0f849e020000    je      nt!PspAllocateThread+0x696 (fffff806`192a3f02)  Branch

nt!PspAllocateThread+0x3f8:
fffff806`192a3c64 488b8424d0010000 mov     rax,qword ptr [rsp+1D0h]
fffff806`192a3c6c 448b00          mov     r8d,dword ptr [rax]
fffff806`192a3c6f 410fb7c8        movzx   ecx,r8w
fffff806`192a3c73 41ba40000000    mov     r10d,40h
fffff806`192a3c79 664123ca        and     cx,r10w
fffff806`192a3c7d 66c1e104        shl     cx,4
fffff806`192a3c81 418bc0          mov     eax,r8d
fffff806`192a3c84 0fb7d1          movzx   edx,cx
fffff806`192a3c87 6683ca08        or      dx,8
fffff806`192a3c8b 2402            and     al,2
fffff806`192a3c8d 660f44d1        cmove   dx,cx
fffff806`192a3c91 418bc0          mov     eax,r8d
fffff806`192a3c94 41b900200000    mov     r9d,2000h
fffff806`192a3c9a 0fb7ca          movzx   ecx,dx
fffff806`192a3c9d 66410bc9        or      cx,r9w
fffff806`192a3ca1 2480            and     al,80h
fffff806`192a3ca3 660f44ca        cmove   cx,dx
fffff806`192a3ca7 0fb7c1          movzx   eax,cx
fffff806`192a3caa ba00400000      mov     edx,4000h
fffff806`192a3caf 660bc2          or      ax,dx
fffff806`192a3cb2 4181e000010000  and     r8d,100h
fffff806`192a3cb9 660f44c1        cmove   ax,cx
fffff806`192a3cbd 6689442454      mov     word ptr [rsp+54h],ax
fffff806`192a3cc2 488b8c2488000000 mov     rcx,qword ptr [rsp+88h]
fffff806`192a3cca 4885c9          test    rcx,rcx
fffff806`192a3ccd 0f8480411900    je      nt!PspAllocateThread+0x1945e7 (fffff806`19437e53)  Branch

nt!PspAllocateThread+0x467:
fffff806`192a3cd3 41859724080000  test    dword ptr [r15+824h],edx
fffff806`192a3cda 0f8538411900    jne     nt!PspAllocateThread+0x1945ac (fffff806`19437e18)  Branch

nt!PspAllocateThread+0x474:
fffff806`192a3ce0 4489642420      mov     dword ptr [rsp+20h],r12d
fffff806`192a3ce5 4c8b442460      mov     r8,qword ptr [rsp+60h]
fffff806`192a3cea 488bd3          mov     rdx,rbx
fffff806`192a3ced 4939bf28040000  cmp     qword ptr [r15+428h],rdi
fffff806`192a3cf4 0f854e020000    jne     nt!PspAllocateThread+0x6dc (fffff806`192a3f48)  Branch

nt!PspAllocateThread+0x48e:
fffff806`192a3cfa 4c8bc9          mov     r9,rcx
fffff806`192a3cfd 498bcf          mov     rcx,r15
fffff806`192a3d00 e8bb0a0000      call    nt!PspSetupUserStack (fffff806`192a47c0)

nt!PspAllocateThread+0x499:
fffff806`192a3d05 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3d09 448bf0          mov     r14d,eax

nt!PspAllocateThread+0x4a0:
fffff806`192a3d0c 4585f6          test    r14d,r14d
fffff806`192a3d0f 0f8876441900    js      nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x4a9:
fffff806`192a3d15 488b842498000000 mov     rax,qword ptr [rsp+98h]
fffff806`192a3d1d 4d85ed          test    r13,r13
fffff806`192a3d20 740e            je      nt!PspAllocateThread+0x4c4 (fffff806`192a3d30)  Branch

nt!PspAllocateThread+0x4b6:
fffff806`192a3d22 41f7450400800000 test    dword ptr [r13+4],8000h
fffff806`192a3d2a 0f8505411900    jne     nt!PspAllocateThread+0x1945c9 (fffff806`19437e35)  Branch

nt!PspAllocateThread+0x4c4:
fffff806`192a3d30 488d4c2470      lea     rcx,[rsp+70h]
fffff806`192a3d35 48894c2420      mov     qword ptr [rsp+20h],rcx
fffff806`192a3d3a 4c8bc8          mov     r9,rax
fffff806`192a3d3d 4c8b442478      mov     r8,qword ptr [rsp+78h]
fffff806`192a3d42 488b542460      mov     rdx,qword ptr [rsp+60h]
fffff806`192a3d47 498bcf          mov     rcx,r15
fffff806`192a3d4a e8e9040000      call    nt!MmCreateTeb (fffff806`192a4238)
fffff806`192a3d4f 448bf0          mov     r14d,eax
fffff806`192a3d52 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3d56 85c0            test    eax,eax
fffff806`192a3d58 0f882d441900    js      nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x4f2:
fffff806`192a3d5e 488b83f8000000  mov     rax,qword ptr [rbx+0F8h]
fffff806`192a3d65 48898610060000  mov     qword ptr [rsi+610h],rax
fffff806`192a3d6c 488b8380000000  mov     rax,qword ptr [rbx+80h]
fffff806`192a3d73 48898690060000  mov     qword ptr [rsi+690h],rax
fffff806`192a3d7a 488b5c2470      mov     rbx,qword ptr [rsp+70h]
fffff806`192a3d7f 4939bf28040000  cmp     qword ptr [r15+428h],rdi
fffff806`192a3d86 0f8532020000    jne     nt!PspAllocateThread+0x752 (fffff806`192a3fbe)  Branch

nt!PspAllocateThread+0x520:
fffff806`192a3d8c 440fb7742454    movzx   r14d,word ptr [rsp+54h]
fffff806`192a3d92 664585f6        test    r14w,r14w
fffff806`192a3d96 0f8593000000    jne     nt!PspAllocateThread+0x5c3 (fffff806`192a3e2f)  Branch

nt!PspAllocateThread+0x530:
fffff806`192a3d9c 4489642440      mov     dword ptr [rsp+40h],r12d
fffff806`192a3da1 4c897c2438      mov     qword ptr [rsp+38h],r15
fffff806`192a3da6 48895c2430      mov     qword ptr [rsp+30h],rbx
fffff806`192a3dab 488b842480000000 mov     rax,qword ptr [rsp+80h]
fffff806`192a3db3 4889442428      mov     qword ptr [rsp+28h],rax
fffff806`192a3db8 488b8610060000  mov     rax,qword ptr [rsi+610h]
fffff806`192a3dbf 4c8b8c24c0010000 mov     r9,qword ptr [rsp+1C0h]
fffff806`192a3dc7 4c8d05227c0200  lea     r8,[nt!PspUserThreadStartup (fffff806`192cb9f0)]

nt!PspAllocateThread+0x562:
fffff806`192a3dce 4889442420      mov     qword ptr [rsp+20h],rax
fffff806`192a3dd3 33d2            xor     edx,edx
fffff806`192a3dd5 488bce          mov     rcx,rsi
fffff806`192a3dd8 e80359f6ff      call    nt!KeInitThread (fffff806`192096e0)
fffff806`192a3ddd 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3de1 448bf0          mov     r14d,eax
fffff806`192a3de4 85c0            test    eax,eax
fffff806`192a3de6 0f885f431900    js      nt!PspAllocateThread+0x1948df (fffff806`1943814b)  Branch

nt!PspAllocateThread+0x580:
fffff806`192a3dec 4d85ed          test    r13,r13
fffff806`192a3def 740e            je      nt!PspAllocateThread+0x593 (fffff806`192a3dff)  Branch

nt!PspAllocateThread+0x585:
fffff806`192a3df1 41f7450400800000 test    dword ptr [r13+4],8000h
fffff806`192a3df9 0f855d431900    jne     nt!PspAllocateThread+0x1948f0 (fffff806`1943815c)  Branch

nt!PspAllocateThread+0x593:
fffff806`192a3dff 488b8424f0000000 mov     rax,qword ptr [rsp+0F0h]
fffff806`192a3e07 488930          mov     qword ptr [rax],rsi
fffff806`192a3e0a 33c0            xor     eax,eax

nt!PspAllocateThread+0x5a0:
fffff806`192a3e0c 488b8c2448010000 mov     rcx,qword ptr [rsp+148h]
fffff806`192a3e14 4833cc          xor     rcx,rsp
fffff806`192a3e17 e84437b9ff      call    nt!_security_check_cookie (fffff806`18e37560)
fffff806`192a3e1c 4881c450010000  add     rsp,150h
fffff806`192a3e23 415f            pop     r15
fffff806`192a3e25 415e            pop     r14
fffff806`192a3e27 415d            pop     r13
fffff806`192a3e29 415c            pop     r12
fffff806`192a3e2b 5f              pop     rdi
fffff806`192a3e2c 5e              pop     rsi
fffff806`192a3e2d 5b              pop     rbx
fffff806`192a3e2e c3              ret

nt!PspAllocateThread+0x5c3:
fffff806`192a3e2f 4c8d842418010000 lea     r8,[rsp+118h]
fffff806`192a3e37 33d2            xor     edx,edx
fffff806`192a3e39 498bcf          mov     rcx,r15
fffff806`192a3e3c e84fe7acff      call    nt!KiStackAttachProcess (fffff806`18d72590)
fffff806`192a3e41 90              nop
fffff806`192a3e42 664489b3ee170000 mov     word ptr [rbx+17EEh],r14w
fffff806`192a3e4a 498b8f28040000  mov     rcx,qword ptr [r15+428h]
fffff806`192a3e51 4885c9          test    rcx,rcx
fffff806`192a3e54 7434            je      nt!PspAllocateThread+0x61e (fffff806`192a3e8a)  Branch

nt!PspAllocateThread+0x5ea:
fffff806`192a3e56 b864860000      mov     eax,8664h
fffff806`192a3e5b 66394108        cmp     word ptr [rcx+8],ax
fffff806`192a3e5f 488d8300200000  lea     rax,[rbx+2000h]
fffff806`192a3e66 7412            je      nt!PspAllocateThread+0x60e (fffff806`192a3e7a)  Branch

nt!PspAllocateThread+0x5fc:
fffff806`192a3e68 48898424e8000000 mov     qword ptr [rsp+0E8h],rax
fffff806`192a3e70 664489b0ca0f0000 mov     word ptr [rax+0FCAh],r14w
fffff806`192a3e78 eb10            jmp     nt!PspAllocateThread+0x61e (fffff806`192a3e8a)  Branch

nt!PspAllocateThread+0x60e:
fffff806`192a3e7a 48898424e0000000 mov     qword ptr [rsp+0E0h],rax
fffff806`192a3e82 664489b0ee170000 mov     word ptr [rax+17EEh],r14w

nt!PspAllocateThread+0x61e:
fffff806`192a3e8a 448bf7          mov     r14d,edi
fffff806`192a3e8d 897c2450        mov     dword ptr [rsp+50h],edi
fffff806`192a3e91 eb35            jmp     nt!PspAllocateThread+0x65c (fffff806`192a3ec8)  Branch

nt!PspAllocateThread+0x65c:
fffff806`192a3ec8 33d2            xor     edx,edx
fffff806`192a3eca 488d8c2418010000 lea     rcx,[rsp+118h]
fffff806`192a3ed2 e899eaacff      call    nt!KiUnstackDetachProcess (fffff806`18d72970)
fffff806`192a3ed7 4585f6          test    r14d,r14d
fffff806`192a3eda 0f89bcfeffff    jns     nt!PspAllocateThread+0x530 (fffff806`192a3d9c)  Branch

nt!PspAllocateThread+0x674:
fffff806`192a3ee0 e9a6421900      jmp     nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x679:
fffff806`192a3ee5 4885f6          test    rsi,rsi
fffff806`192a3ee8 0f8457fbffff    je      nt!PspAllocateThread+0x1d9 (fffff806`192a3a45)  Branch

nt!PspAllocateThread+0x682:
fffff806`192a3eee 8b4618          mov     eax,dword ptr [rsi+18h]
fffff806`192a3ef1 25f21f0100      and     eax,11FF2h
fffff806`192a3ef6 41898680010000  mov     dword ptr [r14+180h],eax
fffff806`192a3efd e943fbffff      jmp     nt!PspAllocateThread+0x1d9 (fffff806`192a3a45)  Branch

nt!PspAllocateThread+0x696:
fffff806`192a3f02 488bdf          mov     rbx,rdi
fffff806`192a3f05 48895c2470      mov     qword ptr [rsp+70h],rbx
fffff806`192a3f0a 4c8b8c24c0010000 mov     r9,qword ptr [rsp+1C0h]
fffff806`192a3f12 4c898e10060000  mov     qword ptr [rsi+610h],r9
fffff806`192a3f19 4c898e90060000  mov     qword ptr [rsi+690h],r9
fffff806`192a3f20 4489642440      mov     dword ptr [rsp+40h],r12d
fffff806`192a3f25 4c897c2438      mov     qword ptr [rsp+38h],r15
fffff806`192a3f2a 48897c2430      mov     qword ptr [rsp+30h],rdi
fffff806`192a3f2f 48897c2428      mov     qword ptr [rsp+28h],rdi
fffff806`192a3f34 488b8424c8010000 mov     rax,qword ptr [rsp+1C8h]
fffff806`192a3f3c 4c8d05cdbdb1ff  lea     r8,[nt!PspSystemThreadStartup (fffff806`18dbfd10)]
fffff806`192a3f43 e986feffff      jmp     nt!PspAllocateThread+0x562 (fffff806`192a3dce)  Branch

nt!PspAllocateThread+0x6dc:
fffff806`192a3f48 4088bc24f8000000 mov     byte ptr [rsp+0F8h],dil
fffff806`192a3f50 48c784240801000000800000 mov qword ptr [rsp+108h],8000h
fffff806`192a3f5c 48c784241001000000000400 mov qword ptr [rsp+110h],40000h
fffff806`192a3f68 4889bc2400010000 mov     qword ptr [rsp+100h],rdi
fffff806`192a3f70 4c8d8c24f8000000 lea     r9,[rsp+0F8h]
fffff806`192a3f78 498bcf          mov     rcx,r15
fffff806`192a3f7b e840080000      call    nt!PspSetupUserStack (fffff806`192a47c0)
fffff806`192a3f80 448bf0          mov     r14d,eax
fffff806`192a3f83 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3f87 85c0            test    eax,eax
fffff806`192a3f89 0f887dfdffff    js      nt!PspAllocateThread+0x4a0 (fffff806`192a3d0c)  Branch

nt!PspAllocateThread+0x723:
fffff806`192a3f8f 488b8c2488000000 mov     rcx,qword ptr [rsp+88h]
fffff806`192a3f97 8a01            mov     al,byte ptr [rcx]
fffff806`192a3f99 328424f8000000  xor     al,byte ptr [rsp+0F8h]
fffff806`192a3fa0 2402            and     al,2
fffff806`192a3fa2 3001            xor     byte ptr [rcx],al
fffff806`192a3fa4 4489642420      mov     dword ptr [rsp+20h],r12d
fffff806`192a3fa9 4c8bc9          mov     r9,rcx
fffff806`192a3fac 4c8b442460      mov     r8,qword ptr [rsp+60h]
fffff806`192a3fb1 498bcf          mov     rcx,r15
fffff806`192a3fb4 e8c3460800      call    nt!PspWow64SetupUserStack (fffff806`1932867c)
fffff806`192a3fb9 e947fdffff      jmp     nt!PspAllocateThread+0x499 (fffff806`192a3d05)  Branch

nt!PspAllocateThread+0x752:
fffff806`192a3fbe 4c8bcb          mov     r9,rbx
fffff806`192a3fc1 4c8b842480000000 mov     r8,qword ptr [rsp+80h]
fffff806`192a3fc9 488b542460      mov     rdx,qword ptr [rsp+60h]
fffff806`192a3fce 498bcf          mov     rcx,r15
fffff806`192a3fd1 e872510700      call    nt!PspWow64InitThread (fffff806`19319148)
fffff806`192a3fd6 448bf0          mov     r14d,eax
fffff806`192a3fd9 89442450        mov     dword ptr [rsp+50h],eax
fffff806`192a3fdd 85c0            test    eax,eax
fffff806`192a3fdf 0f89a7fdffff    jns     nt!PspAllocateThread+0x520 (fffff806`192a3d8c)  Branch

nt!PspAllocateThread+0x779:
fffff806`192a3fe5 e9a1411900      jmp     nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x77e:
fffff806`192a3fea 48393b          cmp     qword ptr [rbx],rdi
fffff806`192a3fed 0f848ef9ffff    je      nt!PspAllocateThread+0x115 (fffff806`192a3981)  Branch

nt!PspAllocateThread+0x787:
fffff806`192a3ff3 488bcb          mov     rcx,rbx
fffff806`192a3ff6 e86dc5b3ff      call    nt!KeSelectNodeForAffinity (fffff806`18de0568)
fffff806`192a3ffb 440fb7a092000000 movzx   r12d,word ptr [rax+92h]
fffff806`192a4003 41ffc4          inc     r12d
fffff806`192a4006 4489642458      mov     dword ptr [rsp+58h],r12d
fffff806`192a400b 410fba6d040e    bts     dword ptr [r13+4],0Eh
fffff806`192a4011 4533c0          xor     r8d,r8d
fffff806`192a4014 488bd3          mov     rdx,rbx
fffff806`192a4017 488bc8          mov     rcx,rax
fffff806`192a401a e85d6ca4ff      call    nt!KeSelectIdealProcessor (fffff806`18ceac7c)
fffff806`192a401f 418985fc000000  mov     dword ptr [r13+0FCh],eax
fffff806`192a4026 4c8b842480000000 mov     r8,qword ptr [rsp+80h]
fffff806`192a402e 448a9424a0010000 mov     r10b,byte ptr [rsp+1A0h]
fffff806`192a4036 4c8b9c24b0000000 mov     r11,qword ptr [rsp+0B0h]
fffff806`192a403e e93ef9ffff      jmp     nt!PspAllocateThread+0x115 (fffff806`192a3981)  Branch

nt!PspAllocateThread+0x7d7:
fffff806`192a4043 418b85fc000000  mov     eax,dword ptr [r13+0FCh]
fffff806`192a404a 488b94c1800d5400 mov     rdx,qword ptr [rcx+rax*8+540D80h]
fffff806`192a4052 e918f9ffff      jmp     nt!PspAllocateThread+0x103 (fffff806`192a396f)  Branch

nt!PspAllocateThread+0x7eb:
fffff806`192a4057 4885db          test    rbx,rbx
fffff806`192a405a 0f84de3c1900    je      nt!PspAllocateThread+0x1944d2 (fffff806`19437d3e)  Branch

nt!PspAllocateThread+0x7f4:
fffff806`192a4060 0fb682d0000000  movzx   eax,byte ptr [rdx+0D0h]
fffff806`192a4067 663b4308        cmp     ax,word ptr [rbx+8]
fffff806`192a406b 0f85c53c1900    jne     nt!PspAllocateThread+0x1944ca (fffff806`19437d36)  Branch

nt!PspAllocateThread+0x805:
fffff806`192a4071 488b0b          mov     rcx,qword ptr [rbx]
fffff806`192a4074 4885c9          test    rcx,rcx
fffff806`192a4077 740d            je      nt!PspAllocateThread+0x81a (fffff806`192a4086)  Branch

nt!PspAllocateThread+0x80d:
fffff806`192a4079 48858ac8000000  test    qword ptr [rdx+0C8h],rcx
fffff806`192a4080 0f84b03c1900    je      nt!PspAllocateThread+0x1944ca (fffff806`19437d36)  Branch

nt!PspAllocateThread+0x81a:
fffff806`192a4086 488b82c0000000  mov     rax,qword ptr [rdx+0C0h]
fffff806`192a408d 440fb7a092000000 movzx   r12d,word ptr [rax+92h]
fffff806`192a4095 41ffc4          inc     r12d
fffff806`192a4098 4489642458      mov     dword ptr [rsp+58h],r12d
fffff806`192a409d e9dff8ffff      jmp     nt!PspAllocateThread+0x115 (fffff806`192a3981)  Branch

nt!PspAllocateThread+0x836:
fffff806`192a40a2 8d4307          lea     eax,[rbx+7]
fffff806`192a40a5 83e0f8          and     eax,0FFFFFFF8h
fffff806`192a40a8 89442478        mov     dword ptr [rsp+78h],eax
fffff806`192a40ac 8d1cc8          lea     ebx,[rax+rcx*8]
fffff806`192a40af e9c1f9ffff      jmp     nt!PspAllocateThread+0x209 (fffff806`192a3a75)  Branch

nt!PspAllocateThread+0x848:
fffff806`192a40b4 0fbaaed006000011 bts     dword ptr [rsi+6D0h],11h
fffff806`192a40bc 4803c6          add     rax,rsi
fffff806`192a40bf 488986c0070000  mov     qword ptr [rsi+7C0h],rax
fffff806`192a40c6 e93dfaffff      jmp     nt!PspAllocateThread+0x29c (fffff806`192a3b08)  Branch

nt!PspAllocateThread+0x85f:
fffff806`192a40cb 48a11400000080f7ffff mov rax,qword ptr [FFFFF78000000014h]
fffff806`192a40d5 488b742468      mov     rsi,qword ptr [rsp+68h]
fffff806`192a40da 488986f0050000  mov     qword ptr [rsi+5F0h],rax
fffff806`192a40e1 448b742450      mov     r14d,dword ptr [rsp+50h]
fffff806`192a40e6 e911fbffff      jmp     nt!PspAllocateThread+0x390 (fffff806`192a3bfc)  Branch

nt!PspAllocateThread+0x1944c2:
fffff806`19437d2e 488bc7          mov     rax,rdi
fffff806`19437d31 e9f6bbe6ff      jmp     nt!PspAllocateThread+0xc0 (fffff806`192a392c)  Branch

nt!PspAllocateThread+0x1944ca:
fffff806`19437d36 41be300000c0    mov     r14d,0C0000030h
fffff806`19437d3c eb4f            jmp     nt!PspAllocateThread+0x194521 (fffff806`19437d8d)  Branch

nt!PspAllocateThread+0x1944d2:
fffff806`19437d3e 410fbae90c      bts     r9d,0Ch
fffff806`19437d43 45894d04        mov     dword ptr [r13+4],r9d
fffff806`19437d47 0fb682d0000000  movzx   eax,byte ptr [rdx+0D0h]
fffff806`19437d4e 6641898548010000 mov     word ptr [r13+148h],ax
fffff806`19437d56 0fb682d0000000  movzx   eax,byte ptr [rdx+0D0h]
fffff806`19437d5d 488b84c1b8f65300 mov     rax,qword ptr [rcx+rax*8+53F6B8h]
fffff806`19437d65 49898540010000  mov     qword ptr [r13+140h],rax
fffff806`19437d6c e915c3e6ff      jmp     nt!PspAllocateThread+0x81a (fffff806`192a4086)  Branch

nt!PspAllocateThread+0x194505:
fffff806`19437d71 4939bf28040000  cmp     qword ptr [r15+428h],rdi
fffff806`19437d78 750d            jne     nt!PspAllocateThread+0x19451b (fffff806`19437d87)  Branch

nt!PspAllocateThread+0x19450e:
fffff806`19437d7a 4d3bbb20020000  cmp     r15,qword ptr [r11+220h]
fffff806`19437d81 0f8408bce6ff    je      nt!PspAllocateThread+0x123 (fffff806`192a398f)  Branch

nt!PspAllocateThread+0x19451b:
fffff806`19437d87 41be0d0000c0    mov     r14d,0C000000Dh

nt!PspAllocateThread+0x194521:
fffff806`19437d8d ba50734372      mov     edx,72437350h
fffff806`19437d92 498bcf          mov     rcx,r15
fffff806`19437d95 e8565a8eff      call    nt!ObfDereferenceObjectWithTag (fffff806`18d1d7f0)
fffff806`19437d9a eb15            jmp     nt!PspAllocateThread+0x194545 (fffff806`19437db1)  Branch

nt!PspAllocateThread+0x194530:
fffff806`19437d9c ba50734372      mov     edx,72437350h
fffff806`19437da1 498bcf          mov     rcx,r15
fffff806`19437da4 e8475a8eff      call    nt!ObfDereferenceObjectWithTag (fffff806`18d1d7f0)

nt!PspAllocateThread+0x19453d:
fffff806`19437da9 488bce          mov     rcx,rsi
fffff806`19437dac e80f268eff      call    nt!ObfDereferenceObject (fffff806`18d1a3c0)

nt!PspAllocateThread+0x194545:
fffff806`19437db1 418bc6          mov     eax,r14d
fffff806`19437db4 e953c0e6ff      jmp     nt!PspAllocateThread+0x5a0 (fffff806`192a3e0c)  Branch

nt!PspAllocateThread+0x19454d:
fffff806`19437db9 f00fba2e16      lock bts dword ptr [rsi],16h
fffff806`19437dbe 448b742450      mov     r14d,dword ptr [rsp+50h]
fffff806`19437dc3 488b742468      mov     rsi,qword ptr [rsp+68h]
fffff806`19437dc8 e92fbde6ff      jmp     nt!PspAllocateThread+0x290 (fffff806`192a3afc)  Branch

nt!PspAllocateThread+0x194561:
fffff806`19437dcd 838ed006000004  or      dword ptr [rsi+6D0h],4
fffff806`19437dd4 e963bde6ff      jmp     nt!PspAllocateThread+0x2d0 (fffff806`192a3b3c)  Branch

nt!PspAllocateThread+0x19456d:
fffff806`19437dd9 4883cbff        or      rbx,0FFFFFFFFFFFFFFFFh
fffff806`19437ddd 488bc3          mov     rax,rbx
fffff806`19437de0 488bb424d8000000 mov     rsi,qword ptr [rsp+0D8h]
fffff806`19437de8 f0480fc106      lock xadd qword ptr [rsi],rax
fffff806`19437ded 2406            and     al,6
fffff806`19437def 3c02            cmp     al,2
fffff806`19437df1 7508            jne     nt!PspAllocateThread+0x19458f (fffff806`19437dfb)  Branch

nt!PspAllocateThread+0x194587:
fffff806`19437df3 488bce          mov     rcx,rsi
fffff806`19437df6 e885b499ff      call    nt!ExfTryToWakePushLock (fffff806`18dd3280)

nt!PspAllocateThread+0x19458f:
fffff806`19437dfb 488bce          mov     rcx,rsi
fffff806`19437dfe e81d578eff      call    nt!KeAbPostRelease (fffff806`18d1d520)
fffff806`19437e03 41be9a0000c0    mov     r14d,0C000009Ah
fffff806`19437e09 4489742450      mov     dword ptr [rsp+50h],r14d
fffff806`19437e0e 488b742468      mov     rsi,qword ptr [rsp+68h]
fffff806`19437e13 e977030000      jmp     nt!PspAllocateThread+0x194923 (fffff806`1943818f)  Branch

nt!PspAllocateThread+0x1945ac:
fffff806`19437e18 4d85ed          test    r13,r13
fffff806`19437e1b 740e            je      nt!PspAllocateThread+0x1945bf (fffff806`19437e2b)  Branch

nt!PspAllocateThread+0x1945b1:
fffff806`19437e1d 41f7450400800000 test    dword ptr [r13+4],8000h
fffff806`19437e25 0f85b5bee6ff    jne     nt!PspAllocateThread+0x474 (fffff806`192a3ce0)  Branch

nt!PspAllocateThread+0x1945bf:
fffff806`19437e2b 0fba6e7414      bts     dword ptr [rsi+74h],14h
fffff806`19437e30 e9abbee6ff      jmp     nt!PspAllocateThread+0x474 (fffff806`192a3ce0)  Branch

nt!PspAllocateThread+0x1945c9:
fffff806`19437e35 48f705d0d4daff00000010 test qword ptr [nt!KeFeatureBits (fffff806`191e5310)],10000000h
fffff806`19437e40 48b90000000001000000 mov rcx,100000000h
fffff806`19437e4a 480f44c1        cmove   rax,rcx
fffff806`19437e4e e9ddbee6ff      jmp     nt!PspAllocateThread+0x4c4 (fffff806`192a3d30)  Branch

nt!PspAllocateThread+0x1945e7:
fffff806`19437e53 4939bf10070000  cmp     qword ptr [r15+710h],rdi
fffff806`19437e5a 0f84a7000000    je      nt!PspAllocateThread+0x19469b (fffff806`19437f07)  Branch

nt!PspAllocateThread+0x1945f4:
fffff806`19437e60 48897c2470      mov     qword ptr [rsp+70h],rdi
fffff806`19437e65 488b83f8000000  mov     rax,qword ptr [rbx+0F8h]
fffff806`19437e6c 48898610060000  mov     qword ptr [rsi+610h],rax
fffff806`19437e73 48898690060000  mov     qword ptr [rsi+690h],rax
fffff806`19437e7a 488b8c2490000000 mov     rcx,qword ptr [rsp+90h]
fffff806`19437e82 488b4108        mov     rax,qword ptr [rcx+8]
fffff806`19437e86 488986a0070000  mov     qword ptr [rsi+7A0h],rax
fffff806`19437e8d 488b4110        mov     rax,qword ptr [rcx+10h]
fffff806`19437e91 488986a8070000  mov     qword ptr [rsi+7A8h],rax
fffff806`19437e98 f00fba2e1a      lock bts dword ptr [rsi],1Ah
fffff806`19437e9d 48b8d803000080f7ffff mov rax,0FFFFF780000003D8h
fffff806`19437ea7 488b00          mov     rax,qword ptr [rax]
fffff806`19437eaa 48f7d8          neg     rax
fffff806`19437ead 1bc9            sbb     ecx,ecx
fffff806`19437eaf 4123ca          and     ecx,r10d
fffff806`19437eb2 81c11f001000    add     ecx,10001Fh
fffff806`19437eb8 488d9424a8000000 lea     rdx,[rsp+0A8h]
fffff806`19437ec0 e8cffc8cff      call    nt!RtlGetExtendedContextLength (fffff806`18d07b94)
fffff806`19437ec5 8b9424a8000000  mov     edx,dword ptr [rsp+0A8h]
fffff806`19437ecc b901000000      mov     ecx,1
fffff806`19437ed1 41b850735363    mov     r8d,63537350h
fffff806`19437ed7 e83451bbff      call    nt!ExAllocatePoolWithTag (fffff806`18fed010)
fffff806`19437edc 488b742468      mov     rsi,qword ptr [rsp+68h]
fffff806`19437ee1 488986d8070000  mov     qword ptr [rsi+7D8h],rax
fffff806`19437ee8 4885c0          test    rax,rax
fffff806`19437eeb 7510            jne     nt!PspAllocateThread+0x194691 (fffff806`19437efd)  Branch

nt!PspAllocateThread+0x194681:
fffff806`19437eed 41be9a0000c0    mov     r14d,0C000009Ah
fffff806`19437ef3 4489742450      mov     dword ptr [rsp+50h],r14d
fffff806`19437ef8 e98e020000      jmp     nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x194691:
fffff806`19437efd 488b5c2470      mov     rbx,qword ptr [rsp+70h]
fffff806`19437f02 e995bee6ff      jmp     nt!PspAllocateThread+0x530 (fffff806`192a3d9c)  Branch

nt!PspAllocateThread+0x19469b:
fffff806`19437f07 488b8424b0000000 mov     rax,qword ptr [rsp+0B0h]
fffff806`19437f0f 488b98f0000000  mov     rbx,qword ptr [rax+0F0h]
fffff806`19437f16 48895c2470      mov     qword ptr [rsp+70h],rbx
fffff806`19437f1b ba01000000      mov     edx,1
fffff806`19437f20 488bc8          mov     rcx,rax
fffff806`19437f23 e8ac318bff      call    nt!PsQueryThreadStartAddress (fffff806`18ceb0d4)
fffff806`19437f28 48898610060000  mov     qword ptr [rsi+610h],rax
fffff806`19437f2f 488b8424b0000000 mov     rax,qword ptr [rsp+0B0h]
fffff806`19437f37 488b8090060000  mov     rax,qword ptr [rax+690h]
fffff806`19437f3e 48898690060000  mov     qword ptr [rsi+690h],rax
fffff806`19437f45 838ed406000010  or      dword ptr [rsi+6D4h],10h
fffff806`19437f4c 498b9728040000  mov     rdx,qword ptr [r15+428h]
fffff806`19437f53 4885d2          test    rdx,rdx
fffff806`19437f56 7422            je      nt!PspAllocateThread+0x19470e (fffff806`19437f7a)  Branch

nt!PspAllocateThread+0x1946ec:
fffff806`19437f58 b864860000      mov     eax,8664h
fffff806`19437f5d b938380000      mov     ecx,3838h
fffff806`19437f62 41b800300000    mov     r8d,3000h
fffff806`19437f68 66394208        cmp     word ptr [rdx+8],ax
fffff806`19437f6c 410f45c8        cmovne  ecx,r8d
fffff806`19437f70 48898c2490000000 mov     qword ptr [rsp+90h],rcx
fffff806`19437f78 eb0c            jmp     nt!PspAllocateThread+0x19471a (fffff806`19437f86)  Branch

nt!PspAllocateThread+0x19470e:
fffff806`19437f7a 48c784249000000038180000 mov qword ptr [rsp+90h],1838h

nt!PspAllocateThread+0x19471a:
fffff806`19437f86 4c8d842418010000 lea     r8,[rsp+118h]
fffff806`19437f8e 33d2            xor     edx,edx
fffff806`19437f90 498bcf          mov     rcx,r15
fffff806`19437f93 e8f8a593ff      call    nt!KiStackAttachProcess (fffff806`18d72590)
fffff806`19437f98 4533c9          xor     r9d,r9d
fffff806`19437f9b 458d4104        lea     r8d,[r9+4]
fffff806`19437f9f 488b942490000000 mov     rdx,qword ptr [rsp+90h]
fffff806`19437fa7 488bcb          mov     rcx,rbx
fffff806`19437faa e8e952edff      call    nt!MmSecureVirtualMemoryEx (fffff806`1930d298)
fffff806`19437faf 4885c0          test    rax,rax
fffff806`19437fb2 0f8483010000    je      nt!PspAllocateThread+0x1948cf (fffff806`1943813b)  Branch

nt!PspAllocateThread+0x19474c:
fffff806`19437fb8 4c8b442478      mov     r8,qword ptr [rsp+78h]
fffff806`19437fbd 410f1000        movups  xmm0,xmmword ptr [r8]
fffff806`19437fc1 f30f7f4340      movdqu  xmmword ptr [rbx+40h],xmm0
fffff806`19437fc6 410f1008        movups  xmm1,xmmword ptr [r8]
fffff806`19437fca f30f7f8bd8070000 movdqu  xmmword ptr [rbx+7D8h],xmm1
fffff806`19437fd2 89bb9c170000    mov     dword ptr [rbx+179Ch],edi
fffff806`19437fd8 89bbe8170000    mov     dword ptr [rbx+17E8h],edi
fffff806`19437fde 41b92c060000    mov     r9d,62Ch
fffff806`19437fe4 6644218bee170000 and     word ptr [rbx+17EEh],r9w
fffff806`19437fec 0fb783ee170000  movzx   eax,word ptr [rbx+17EEh]
fffff806`19437ff3 0fb7542454      movzx   edx,word ptr [rsp+54h]
fffff806`19437ff8 660bc2          or      ax,dx
fffff806`19437ffb 41ba40000000    mov     r10d,40h
fffff806`19438001 66410bc2        or      ax,r10w
fffff806`19438005 668983ee170000  mov     word ptr [rbx+17EEh],ax
fffff806`1943800c 498b8f28040000  mov     rcx,qword ptr [r15+428h]
fffff806`19438013 4885c9          test    rcx,rcx
fffff806`19438016 0f84e0000000    je      nt!PspAllocateThread+0x194890 (fffff806`194380fc)  Branch

nt!PspAllocateThread+0x1947b0:
fffff806`1943801c b864860000      mov     eax,8664h
fffff806`19438021 66394108        cmp     word ptr [rcx+8],ax
fffff806`19438025 488d8b00200000  lea     rcx,[rbx+2000h]
fffff806`1943802c 755d            jne     nt!PspAllocateThread+0x19481f (fffff806`1943808b)  Branch

nt!PspAllocateThread+0x1947c2:
fffff806`1943802e 48898c24e0000000 mov     qword ptr [rsp+0E0h],rcx
fffff806`19438036 498b00          mov     rax,qword ptr [r8]
fffff806`19438039 48894140        mov     qword ptr [rcx+40h],rax
fffff806`1943803d 488b8640060000  mov     rax,qword ptr [rsi+640h]
fffff806`19438044 48894148        mov     qword ptr [rcx+48h],rax
fffff806`19438048 498b00          mov     rax,qword ptr [r8]
fffff806`1943804b 488981d8070000  mov     qword ptr [rcx+7D8h],rax
fffff806`19438052 488b8640060000  mov     rax,qword ptr [rsi+640h]
fffff806`19438059 488981e0070000  mov     qword ptr [rcx+7E0h],rax
fffff806`19438060 89b99c170000    mov     dword ptr [rcx+179Ch],edi
fffff806`19438066 89b9e8170000    mov     dword ptr [rcx+17E8h],edi
fffff806`1943806c 66442189ee170000 and     word ptr [rcx+17EEh],r9w
fffff806`19438074 0fb781ee170000  movzx   eax,word ptr [rcx+17EEh]
fffff806`1943807b 660bc2          or      ax,dx
fffff806`1943807e 66410bc2        or      ax,r10w
fffff806`19438082 668981ee170000  mov     word ptr [rcx+17EEh],ax
fffff806`19438089 eb71            jmp     nt!PspAllocateThread+0x194890 (fffff806`194380fc)  Branch

nt!PspAllocateThread+0x19481f:
fffff806`1943808b 48898c24e8000000 mov     qword ptr [rsp+0E8h],rcx
fffff806`19438093 418b00          mov     eax,dword ptr [r8]
fffff806`19438096 898424c8000000  mov     dword ptr [rsp+0C8h],eax
fffff806`1943809d 894120          mov     dword ptr [rcx+20h],eax
fffff806`194380a0 8b8640060000    mov     eax,dword ptr [rsi+640h]
fffff806`194380a6 898424cc000000  mov     dword ptr [rsp+0CCh],eax
fffff806`194380ad 894124          mov     dword ptr [rcx+24h],eax
fffff806`194380b0 418b00          mov     eax,dword ptr [r8]
fffff806`194380b3 898424d0000000  mov     dword ptr [rsp+0D0h],eax
fffff806`194380ba 8981b4060000    mov     dword ptr [rcx+6B4h],eax
fffff806`194380c0 8b8640060000    mov     eax,dword ptr [rsi+640h]
fffff806`194380c6 898424d4000000  mov     dword ptr [rsp+0D4h],eax
fffff806`194380cd 8981b8060000    mov     dword ptr [rcx+6B8h],eax
fffff806`194380d3 89b99c0f0000    mov     dword ptr [rcx+0F9Ch],edi
fffff806`194380d9 89b9c40f0000    mov     dword ptr [rcx+0FC4h],edi
fffff806`194380df 66442189ca0f0000 and     word ptr [rcx+0FCAh],r9w
fffff806`194380e7 0fb781ca0f0000  movzx   eax,word ptr [rcx+0FCAh]
fffff806`194380ee 660bc2          or      ax,dx
fffff806`194380f1 66410bc2        or      ax,r10w
fffff806`194380f5 668981ca0f0000  mov     word ptr [rcx+0FCAh],ax

nt!PspAllocateThread+0x194890:
fffff806`194380fc e9c7bde6ff      jmp     nt!PspAllocateThread+0x65c (fffff806`192a3ec8)  Branch

nt!PspAllocateThread+0x1948cf:
fffff806`1943813b 41be410100c0    mov     r14d,0C0000141h
fffff806`19438141 4489742450      mov     dword ptr [rsp+50h],r14d
fffff806`19438146 e97dbde6ff      jmp     nt!PspAllocateThread+0x65c (fffff806`192a3ec8)  Branch

nt!PspAllocateThread+0x1948df:
fffff806`1943814b 4885db          test    rbx,rbx
fffff806`1943814e 743b            je      nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x1948e4:
fffff806`19438150 4839bc2488000000 cmp     qword ptr [rsp+88h],rdi
fffff806`19438158 7431            je      nt!PspAllocateThread+0x19491f (fffff806`1943818b)  Branch

nt!PspAllocateThread+0x1948ee:
fffff806`1943815a eb24            jmp     nt!PspAllocateThread+0x194914 (fffff806`19438180)  Branch

nt!PspAllocateThread+0x1948f0:
fffff806`1943815c 4c8bcb          mov     r9,rbx
fffff806`1943815f 4d8bc5          mov     r8,r13
fffff806`19438162 8a9424a0010000  mov     dl,byte ptr [rsp+1A0h]
fffff806`19438169 488bce          mov     rcx,rsi
fffff806`1943816c e85b7f0f00      call    nt!PspUmsInitThread (fffff806`195300cc)
fffff806`19438171 448bf0          mov     r14d,eax
fffff806`19438174 89442450        mov     dword ptr [rsp+50h],eax
fffff806`19438178 85c0            test    eax,eax
fffff806`1943817a 0f897fbce6ff    jns     nt!PspAllocateThread+0x593 (fffff806`192a3dff)  Branch

nt!PspAllocateThread+0x194914:
fffff806`19438180 488bd3          mov     rdx,rbx
fffff806`19438183 498bcf          mov     rcx,r15
fffff806`19438186 e8698ce2ff      call    nt!MmDeleteTeb (fffff806`19260df4)

nt!PspAllocateThread+0x19491f:
fffff806`1943818b 4883cbff        or      rbx,0FFFFFFFFFFFFFFFFh

nt!PspAllocateThread+0x194923:
fffff806`1943818f 488b842488000000 mov     rax,qword ptr [rsp+88h]
fffff806`19438197 4885c0          test    rax,rax
fffff806`1943819a 7415            je      nt!PspAllocateThread+0x194945 (fffff806`194381b1)  Branch

nt!PspAllocateThread+0x194930:
fffff806`1943819c 403838          cmp     byte ptr [rax],dil
fffff806`1943819f 7410            je      nt!PspAllocateThread+0x194945 (fffff806`194381b1)  Branch

nt!PspAllocateThread+0x194935:
fffff806`194381a1 4c8bc8          mov     r9,rax
fffff806`194381a4 4c8b442460      mov     r8,qword ptr [rsp+60h]
fffff806`194381a9 498bcf          mov     rcx,r15
fffff806`194381ac e81ff6efff      call    nt!PspDeleteUserStack (fffff806`193377d0)

nt!PspAllocateThread+0x194945:
fffff806`194381b1 488b8ed8070000  mov     rcx,qword ptr [rsi+7D8h]
fffff806`194381b8 4885c9          test    rcx,rcx
fffff806`194381bb 7411            je      nt!PspAllocateThread+0x194962 (fffff806`194381ce)  Branch

nt!PspAllocateThread+0x194951:
fffff806`194381bd ba50735363      mov     edx,63537350h
fffff806`194381c2 e8995abbff      call    nt!ExFreePoolWithTag (fffff806`18fedc60)
fffff806`194381c7 4889bed8070000  mov     qword ptr [rsi+7D8h],rdi

nt!PspAllocateThread+0x194962:
fffff806`194381ce 4839be40060000  cmp     qword ptr [rsi+640h],rdi
fffff806`194381d5 7433            je      nt!PspAllocateThread+0x19499e (fffff806`1943820a)  Branch

nt!PspAllocateThread+0x19496b:
fffff806`194381d7 f0480fc19ec0060000 lock xadd qword ptr [rsi+6C0h],rbx
fffff806`194381e0 80e306          and     bl,6
fffff806`194381e3 80fb02          cmp     bl,2
fffff806`194381e6 750c            jne     nt!PspAllocateThread+0x194988 (fffff806`194381f4)  Branch

nt!PspAllocateThread+0x19497c:
fffff806`194381e8 488d8ec0060000  lea     rcx,[rsi+6C0h]
fffff806`194381ef e88cb099ff      call    nt!ExfTryToWakePushLock (fffff806`18dd3280)

nt!PspAllocateThread+0x194988:
fffff806`194381f4 488d8ec0060000  lea     rcx,[rsi+6C0h]
fffff806`194381fb e820538eff      call    nt!KeAbPostRelease (fffff806`18d1d520)
fffff806`19438200 448b742450      mov     r14d,dword ptr [rsp+50h]
fffff806`19438205 488b742468      mov     rsi,qword ptr [rsp+68h]

nt!PspAllocateThread+0x19499e:
fffff806`1943820a 4839be20020000  cmp     qword ptr [rsi+220h],rdi
fffff806`19438211 0f8592fbffff    jne     nt!PspAllocateThread+0x19453d (fffff806`19437da9)  Branch

nt!PspAllocateThread+0x1949ab:
fffff806`19438217 e980fbffff      jmp     nt!PspAllocateThread+0x194530 (fffff806`19437d9c)  Branch
