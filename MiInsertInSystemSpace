0: kd> uf MiInsertInSystemSpace
nt!MiInsertInSystemSpace:
fffff800`599421d0 4c894c2420      mov     qword ptr [rsp+20h],r9
fffff800`599421d5 4c89442418      mov     qword ptr [rsp+18h],r8
fffff800`599421da 48894c2408      mov     qword ptr [rsp+8],rcx
fffff800`599421df 53              push    rbx
fffff800`599421e0 55              push    rbp
fffff800`599421e1 56              push    rsi
fffff800`599421e2 57              push    rdi
fffff800`599421e3 4154            push    r12
fffff800`599421e5 4155            push    r13
fffff800`599421e7 4156            push    r14
fffff800`599421e9 4157            push    r15
fffff800`599421eb 4881ec58010000  sub     rsp,158h
fffff800`599421f2 488b8c24d0010000 mov     rcx,qword ptr [rsp+1D0h]
fffff800`599421fa 4c8d0d37593a00  lea     r9,[nt!MiState+0x2178 (fffff800`59ce7b38)]
fffff800`59942201 33ff            xor     edi,edi
fffff800`59942203 4c894c2468      mov     qword ptr [rsp+68h],r9
fffff800`59942208 498bc0          mov     rax,r8
fffff800`5994220b 48897c2470      mov     qword ptr [rsp+70h],rdi
fffff800`59942210 41bc03000000    mov     r12d,3
fffff800`59942216 48897c2460      mov     qword ptr [rsp+60h],rdi
fffff800`5994221b 488939          mov     qword ptr [rcx],rdi
fffff800`5994221e 41baffff0700    mov     r10d,7FFFFh
fffff800`59942224 488bc8          mov     rcx,rax
fffff800`59942227 4489542440      mov     dword ptr [rsp+40h],r10d
fffff800`5994222c 488bea          mov     rbp,rdx
fffff800`5994222f 4088bc24a8010000 mov     byte ptr [rsp+1A8h],dil
fffff800`59942237 448bff          mov     r15d,edi
fffff800`5994223a 4889bc2480000000 mov     qword ptr [rsp+80h],rdi
fffff800`59942242 448bc7          mov     r8d,edi
fffff800`59942245 48897c2458      mov     qword ptr [rsp+58h],rdi
fffff800`5994224a 448bf7          mov     r14d,edi
fffff800`5994224d 4489642450      mov     dword ptr [rsp+50h],r12d
fffff800`59942252 8bf7            mov     esi,edi
fffff800`59942254 448bdf          mov     r11d,edi
fffff800`59942257 458bec          mov     r13d,r12d
fffff800`5994225a e861420300      call    nt!MiSectionControlArea (fffff800`599764c0)
fffff800`5994225f 6685ed          test    bp,bp
fffff800`59942262 4889442448      mov     qword ptr [rsp+48h],rax
fffff800`59942267 488bc8          mov     rcx,rax
fffff800`5994226a 8bdf            mov     ebx,edi
fffff800`5994226c 0f95c3          setne   bl
fffff800`5994226f 488bc5          mov     rax,rbp
fffff800`59942272 48c1e810        shr     rax,10h
fffff800`59942276 03d8            add     ebx,eax
fffff800`59942278 81fb00000100    cmp     ebx,10000h
fffff800`5994227e 0f839a4e1800    jae     nt!MiInsertInSystemSpace+0x184f4e (fffff800`59ac711e)  Branch

nt!MiInsertInSystemSpace+0xb4:
fffff800`59942284 488b9424b8010000 mov     rdx,qword ptr [rsp+1B8h]
fffff800`5994228c 4c8d8424b0000000 lea     r8,[rsp+0B0h]
fffff800`59942294 488b12          mov     rdx,qword ptr [rdx]
fffff800`59942297 e884700400      call    nt!MiOffsetToProtos (fffff800`59989320)
fffff800`5994229c 4889842490000000 mov     qword ptr [rsp+90h],rax
fffff800`599422a4 4885c0          test    rax,rax
fffff800`599422a7 0f847e4e1800    je      nt!MiInsertInSystemSpace+0x184f5b (fffff800`59ac712b)  Branch

nt!MiInsertInSystemSpace+0xdd:
fffff800`599422ad 488d050c3c3a00  lea     rax,[nt!MiState+0x500 (fffff800`59ce5ec0)]
fffff800`599422b4 8d4f01          lea     ecx,[rdi+1]
fffff800`599422b7 48398424a0010000 cmp     qword ptr [rsp+1A0h],rax
fffff800`599422bf 0f85f8050000    jne     nt!MiInsertInSystemSpace+0x6ed (fffff800`599428bd)  Branch

nt!MiInsertInSystemSpace+0xf5:
fffff800`599422c5 e89a1d0100      call    nt!MiGetAnyMultiplexedVm (fffff800`59954064)
fffff800`599422ca 48898424a0000000 mov     qword ptr [rsp+0A0h],rax
fffff800`599422d2 448be7          mov     r12d,edi
fffff800`599422d5 488b8424c8010000 mov     rax,qword ptr [rsp+1C8h]
fffff800`599422dd b980020000      mov     ecx,280h
fffff800`599422e2 83e008          and     eax,8
fffff800`599422e5 4889bc24a8000000 mov     qword ptr [rsp+0A8h],rdi
fffff800`599422ed ba80000000      mov     edx,80h
fffff800`599422f2 c784248c000000ffffffff mov dword ptr [rsp+8Ch],0FFFFFFFFh
fffff800`599422fd 410f95c4        setne   r12b
fffff800`59942301 4503e5          add     r12d,r13d
fffff800`59942304 4885c0          test    rax,rax
fffff800`59942307 0f44ca          cmove   ecx,edx
fffff800`5994230a 898c2488000000  mov     dword ptr [rsp+88h],ecx

nt!MiInsertInSystemSpace+0x141:
fffff800`59942311 48f7c5ff0f0000  test    rbp,0FFFh
fffff800`59942318 400f95c6        setne   sil
fffff800`5994231c c1e304          shl     ebx,4
fffff800`5994231f 8bc3            mov     eax,ebx
fffff800`59942321 4889842480000000 mov     qword ptr [rsp+80h],rax
fffff800`59942329 488b8424a0000000 mov     rax,qword ptr [rsp+0A0h]
fffff800`59942331 48c1ed0c        shr     rbp,0Ch
fffff800`59942335 4803f5          add     rsi,rbp
fffff800`59942338 0fb788ae000000  movzx   ecx,word ptr [rax+0AEh]
fffff800`5994233f 488b0582533a00  mov     rax,qword ptr [nt!MiState+0x1d08 (fffff800`59ce76c8)]
fffff800`59942346 488b04c8        mov     rax,qword ptr [rax+rcx*8]
fffff800`5994234a 488b4c2448      mov     rcx,qword ptr [rsp+48h]
fffff800`5994234f 4889442458      mov     qword ptr [rsp+58h],rax
fffff800`59942354 f7413820040000  test    dword ptr [rcx+38h],420h
fffff800`5994235b 0f850e050000    jne     nt!MiInsertInSystemSpace+0x69f (fffff800`5994286f)  Branch

nt!MiInsertInSystemSpace+0x191:
fffff800`59942361 488b9424b8010000 mov     rdx,qword ptr [rsp+1B8h]
fffff800`59942369 488d442450      lea     rax,[rsp+50h]
fffff800`5994236e 448bcf          mov     r9d,edi
fffff800`59942371 4889442420      mov     qword ptr [rsp+20h],rax
fffff800`59942376 4183fc02        cmp     r12d,2
fffff800`5994237a 4c8bc6          mov     r8,rsi
fffff800`5994237d 410f95c1        setne   r9b
fffff800`59942381 e8aefbffff      call    nt!MiReferenceDataSubsections (fffff800`59941f34)
fffff800`59942386 448b6c2450      mov     r13d,dword ptr [rsp+50h]
fffff800`5994238b 8bd8            mov     ebx,eax
fffff800`5994238d 85c0            test    eax,eax
fffff800`5994238f 0f88054e1800    js      nt!MiInsertInSystemSpace+0x184fca (fffff800`59ac719a)  Branch

nt!MiInsertInSystemSpace+0x1c5:
fffff800`59942395 40b501          mov     bpl,1
fffff800`59942398 4088ac24a8010000 mov     byte ptr [rsp+1A8h],bpl
fffff800`599423a0 4183fd03        cmp     r13d,3
fffff800`599423a4 0f829b4d1800    jb      nt!MiInsertInSystemSpace+0x184f75 (fffff800`59ac7145)  Branch

nt!MiInsertInSystemSpace+0x1da:
fffff800`599423aa 8b942480000000  mov     edx,dword ptr [rsp+80h]
fffff800`599423b1 488b4c2468      mov     rcx,qword ptr [rsp+68h]
fffff800`599423b6 e8e5e40800      call    nt!MiReservePtes (fffff800`599d08a0)
fffff800`599423bb 4c8bf0          mov     r14,rax
fffff800`599423be 4885c0          test    rax,rax
fffff800`599423c1 0f84de4d1800    je      nt!MiInsertInSystemSpace+0x184fd5 (fffff800`59ac71a5)  Branch

nt!MiInsertInSystemSpace+0x1f7:
fffff800`599423c7 488bd8          mov     rbx,rax
fffff800`599423ca 48b8000000000088ffff mov rax,0FFFF880000000000h
fffff800`599423d4 48c1e319        shl     rbx,19h
fffff800`599423d8 488bc0          mov     rax,rax
fffff800`599423db 48c1e019        shl     rax,19h
fffff800`599423df 482bd8          sub     rbx,rax
fffff800`599423e2 48c1fb10        sar     rbx,10h
fffff800`599423e6 48895c2470      mov     qword ptr [rsp+70h],rbx

nt!MiInsertInSystemSpace+0x21b:
fffff800`599423eb ba68000000      mov     edx,68h
fffff800`599423f0 b900020000      mov     ecx,200h
fffff800`599423f5 41b84d695677    mov     r8d,7756694Dh
fffff800`599423fb e8303c2b00      call    nt!ExAllocatePoolWithTag (fffff800`59bf6030)
fffff800`59942400 4c8bf8          mov     r15,rax
fffff800`59942403 4885c0          test    rax,rax
fffff800`59942406 0f84a64d1800    je      nt!MiInsertInSystemSpace+0x184fe2 (fffff800`59ac71b2)  Branch

nt!MiInsertInSystemSpace+0x23c:
fffff800`5994240c 33d2            xor     edx,edx
fffff800`5994240e 488bc8          mov     rcx,rax
fffff800`59942411 448d4268        lea     r8d,[rdx+68h]
fffff800`59942415 e866fb1200      call    nt!memset (fffff800`59a71f80)
fffff800`5994241a 4c8b5c2448      mov     r11,qword ptr [rsp+48h]
fffff800`5994241f 428d04ed00000000 lea     eax,[r13*8]
fffff800`59942427 41334738        xor     eax,dword ptr [r15+38h]
fffff800`5994242b 418bd4          mov     edx,r12d
fffff800`5994242e 83e018          and     eax,18h
fffff800`59942431 498bcb          mov     rcx,r11
fffff800`59942434 41314738        xor     dword ptr [r15+38h],eax
fffff800`59942438 e8eb840300      call    nt!MiControlAreaRequiresCharge (fffff800`5997a928)
fffff800`5994243d 8bd8            mov     ebx,eax
fffff800`5994243f 85c0            test    eax,eax
fffff800`59942441 0f84784d1800    je      nt!MiInsertInSystemSpace+0x184fef (fffff800`59ac71bf)  Branch

nt!MiInsertInSystemSpace+0x277:
fffff800`59942447 83f802          cmp     eax,2
fffff800`5994244a 0f847c4d1800    je      nt!MiInsertInSystemSpace+0x184ffc (fffff800`59ac71cc)  Branch

nt!MiInsertInSystemSpace+0x280:
fffff800`59942450 488bac24b0010000 mov     rbp,qword ptr [rsp+1B0h]
fffff800`59942458 f7453800000008  test    dword ptr [rbp+38h],8000000h
fffff800`5994245f 0f85714d1800    jne     nt!MiInsertInSystemSpace+0x185006 (fffff800`59ac71d6)  Branch

nt!MiInsertInSystemSpace+0x295:
fffff800`59942465 f68424c001000001 test    byte ptr [rsp+1C0h],1
fffff800`5994246d 0f85f2030000    jne     nt!MiInsertInSystemSpace+0x695 (fffff800`59942865)  Branch

nt!MiInsertInSystemSpace+0x2a3:
fffff800`59942473 418b4338        mov     eax,dword ptr [r11+38h]
fffff800`59942477 a820            test    al,20h
fffff800`59942479 0f85f8030000    jne     nt!MiInsertInSystemSpace+0x6a7 (fffff800`59942877)  Branch

nt!MiInsertInSystemSpace+0x2af:
fffff800`5994247f 4c8b642470      mov     r12,qword ptr [rsp+70h]
fffff800`59942484 488bc6          mov     rax,rsi
fffff800`59942487 4c8bac24a0010000 mov     r13,qword ptr [rsp+1A0h]
fffff800`5994248f 48c1e00c        shl     rax,0Ch
fffff800`59942493 49894720        mov     qword ptr [r15+20h],rax
fffff800`59942497 488b842490000000 mov     rax,qword ptr [rsp+90h]
fffff800`5994249f 49894730        mov     qword ptr [r15+30h],rax
fffff800`599424a3 488b8424b8010000 mov     rax,qword ptr [rsp+1B8h]
fffff800`599424ab 488b00          mov     rax,qword ptr [rax]
fffff800`599424ae 48c1e80c        shr     rax,0Ch
fffff800`599424b2 49894718        mov     qword ptr [r15+18h],rax
fffff800`599424b6 488b442460      mov     rax,qword ptr [rsp+60h]
fffff800`599424bb 49894728        mov     qword ptr [r15+28h],rax
fffff800`599424bf 498bc4          mov     rax,r12
fffff800`599424c2 4883c802        or      rax,2
fffff800`599424c6 49894758        mov     qword ptr [r15+58h],rax
fffff800`599424ca 8b442440        mov     eax,dword ptr [rsp+40h]
fffff800`599424ce 41894764        mov     dword ptr [r15+64h],eax
fffff800`599424d2 488d05e7393a00  lea     rax,[nt!MiState+0x500 (fffff800`59ce5ec0)]
fffff800`599424d9 4c3be8          cmp     r13,rax
fffff800`599424dc 0f8538040000    jne     nt!MiInsertInSystemSpace+0x74a (fffff800`5994291a)  Branch

nt!MiInsertInSystemSpace+0x312:
fffff800`599424e2 b8ffffffff      mov     eax,0FFFFFFFFh

nt!MiInsertInSystemSpace+0x317:
fffff800`599424e7 488bcd          mov     rcx,rbp
fffff800`599424ea 41894760        mov     dword ptr [r15+60h],eax
fffff800`599424ee e8954b5200      call    nt!MiReferenceFileObjectForMap (fffff800`59e67088)
fffff800`599424f3 49894740        mov     qword ptr [r15+40h],rax
fffff800`599424f7 65488b042588010000 mov   rax,qword ptr gs:[188h]
fffff800`59942500 8b5c2450        mov     ebx,dword ptr [rsp+50h]
fffff800`59942504 48898424a8010000 mov     qword ptr [rsp+1A8h],rax
fffff800`5994250c 85db            test    ebx,ebx
fffff800`5994250e 0f842f4e1800    je      nt!MiInsertInSystemSpace+0x185173 (fffff800`59ac7343)  Branch

nt!MiInsertInSystemSpace+0x344:
fffff800`59942514 66ff88e6010000  dec     word ptr [rax+1E6h]
fffff800`5994251b 498b4d08        mov     rcx,qword ptr [r13+8]
fffff800`5994251f 33d2            xor     edx,edx
fffff800`59942521 e8bab20700      call    nt!ExAcquirePushLockExclusiveEx (fffff800`599bd7e0)
fffff800`59942526 4c8bac24a0000000 mov     r13,qword ptr [rsp+0A0h]
fffff800`5994252e 498bcd          mov     rcx,r13
fffff800`59942531 e8aa520300      call    nt!MiGetSharedVm (fffff800`599777e0)
fffff800`59942536 488bc8          mov     rcx,rax
fffff800`59942539 488bd8          mov     rbx,rax
fffff800`5994253c e82f660200      call    nt!ExAcquireSpinLockExclusive (fffff800`59968b70)
fffff800`59942541 897b04          mov     dword ptr [rbx+4],edi
fffff800`59942544 4532c0          xor     r8b,r8b
fffff800`59942547 488b9c24a0010000 mov     rbx,qword ptr [rsp+1A0h]
fffff800`5994254f 0fb6e8          movzx   ebp,al
fffff800`59942552 ff4318          inc     dword ptr [rbx+18h]
fffff800`59942555 488b5310        mov     rdx,qword ptr [rbx+10h]
fffff800`59942559 4885d2          test    rdx,rdx
fffff800`5994255c 743c            je      nt!MiInsertInSystemSpace+0x3ca (fffff800`5994259a)  Branch

nt!MiInsertInSystemSpace+0x38e:
fffff800`5994255e 6690            nop

nt!MiInsertInSystemSpace+0x390:
fffff800`59942560 4c8b4258        mov     r8,qword ptr [rdx+58h]
fffff800`59942564 488b4a20        mov     rcx,qword ptr [rdx+20h]
fffff800`59942568 4981e000f0ffff  and     r8,0FFFFFFFFFFFFF000h
fffff800`5994256f 4903c8          add     rcx,r8
fffff800`59942572 4c3be1          cmp     r12,rcx
fffff800`59942575 720e            jb      nt!MiInsertInSystemSpace+0x3b5 (fffff800`59942585)  Branch

nt!MiInsertInSystemSpace+0x3a7:
fffff800`59942577 488b4208        mov     rax,qword ptr [rdx+8]
fffff800`5994257b 4885c0          test    rax,rax
fffff800`5994257e 7417            je      nt!MiInsertInSystemSpace+0x3c7 (fffff800`59942597)  Branch

nt!MiInsertInSystemSpace+0x3b0:
fffff800`59942580 488bd0          mov     rdx,rax
fffff800`59942583 ebdb            jmp     nt!MiInsertInSystemSpace+0x390 (fffff800`59942560)  Branch

nt!MiInsertInSystemSpace+0x3b5:
fffff800`59942585 4d3be0          cmp     r12,r8
fffff800`59942588 73ed            jae     nt!MiInsertInSystemSpace+0x3a7 (fffff800`59942577)  Branch

nt!MiInsertInSystemSpace+0x3ba:
fffff800`5994258a 488b02          mov     rax,qword ptr [rdx]
fffff800`5994258d 4885c0          test    rax,rax
fffff800`59942590 75ee            jne     nt!MiInsertInSystemSpace+0x3b0 (fffff800`59942580)  Branch

nt!MiInsertInSystemSpace+0x3c2:
fffff800`59942592 4532c0          xor     r8b,r8b
fffff800`59942595 eb03            jmp     nt!MiInsertInSystemSpace+0x3ca (fffff800`5994259a)  Branch

nt!MiInsertInSystemSpace+0x3c7:
fffff800`59942597 41b001          mov     r8b,1

nt!MiInsertInSystemSpace+0x3ca:
fffff800`5994259a 4d8bcf          mov     r9,r15
fffff800`5994259d 488d4b10        lea     rcx,[rbx+10h]
fffff800`599425a1 e84a500300      call    nt!RtlAvlInsertNodeEx (fffff800`599775f0)
fffff800`599425a6 400fb6d5        movzx   edx,bpl
fffff800`599425aa 498bcd          mov     rcx,r13
fffff800`599425ad e85e520300      call    nt!MiUnlockWorkingSetExclusive (fffff800`59977810)
fffff800`599425b2 488b4c2448      mov     rcx,qword ptr [rsp+48h]
fffff800`599425b7 f7413800040000  test    dword ptr [rcx+38h],400h
fffff800`599425be 751f            jne     nt!MiInsertInSystemSpace+0x40f (fffff800`599425df)  Branch

nt!MiInsertInSystemSpace+0x3f0:
fffff800`599425c0 48898c24c0000000 mov     qword ptr [rsp+0C0h],rcx
fffff800`599425c8 498d5748        lea     rdx,[r15+48h]
fffff800`599425cc 488d8c24c0000000 lea     rcx,[rsp+0C0h]
fffff800`599425d4 41b803000000    mov     r8d,3
fffff800`599425da e821510400      call    nt!MiManageSubsectionView (fffff800`59987700)

nt!MiInsertInSystemSpace+0x40f:
fffff800`599425df 4c8b6308        mov     r12,qword ptr [rbx+8]
fffff800`599425e3 48c7c0ffffffff  mov     rax,0FFFFFFFFFFFFFFFFh
fffff800`599425ea f0490fc10424    lock xadd qword ptr [r12],rax
fffff800`599425f0 2406            and     al,6
fffff800`599425f2 3c02            cmp     al,2
fffff800`599425f4 0f8452030000    je      nt!MiInsertInSystemSpace+0x77c (fffff800`5994294c)  Branch

nt!MiInsertInSystemSpace+0x42a:
fffff800`599425fa 897c2478        mov     dword ptr [rsp+78h],edi
fffff800`599425fe 498bcc          mov     rcx,r12
fffff800`59942601 65488b2c2588010000 mov   rbp,qword ptr gs:[188h]
fffff800`5994260a e891b10700      call    nt!MiGetSystemRegionType (fffff800`599bd7a0)
fffff800`5994260f 83f801          cmp     eax,1
fffff800`59942612 0f8439020000    je      nt!MiInsertInSystemSpace+0x681 (fffff800`59942851)  Branch

nt!MiInsertInSystemSpace+0x448:
fffff800`59942618 41b9ffffffff    mov     r9d,0FFFFFFFFh

nt!MiInsertInSystemSpace+0x44e:
fffff800`5994261e 66ff8de6010000  dec     word ptr [rbp+1E6h]
fffff800`59942625 fe851a030000    inc     byte ptr [rbp+31Ah]
fffff800`5994262b 0fbe8d18030000  movsx   ecx,byte ptr [rbp+318h]
fffff800`59942632 448bef          mov     r13d,edi
fffff800`59942635 80bd1a03000001  cmp     byte ptr [rbp+31Ah],1
fffff800`5994263c 41bb01000000    mov     r11d,1
fffff800`59942642 0fbe958e050000  movsx   edx,byte ptr [rbp+58Eh]
fffff800`59942649 4d8bc4          mov     r8,r12
fffff800`5994264c 450f44eb        cmove   r13d,r11d
fffff800`59942650 49bafcffffffffffff7f mov r10,7FFFFFFFFFFFFFFCh
fffff800`5994265a 0bd1            or      edx,ecx
fffff800`5994265c 4d23c2          and     r8,r10
fffff800`5994265f 83f23f          xor     edx,3Fh
fffff800`59942662 0fbdca          bsr     ecx,edx
fffff800`59942665 898c2498000000  mov     dword ptr [rsp+98h],ecx
fffff800`5994266c 0f84c8020000    je      nt!MiInsertInSystemSpace+0x76a (fffff800`5994293a)  Branch

nt!MiInsertInSystemSpace+0x4a2:
fffff800`59942672 418bc3          mov     eax,r11d
fffff800`59942675 488d9d20030000  lea     rbx,[rbp+320h]
fffff800`5994267c d3e0            shl     eax,cl
fffff800`5994267e 488d0c49        lea     rcx,[rcx+rcx*2]
fffff800`59942682 48c1e105        shl     rcx,5
fffff800`59942686 f7d0            not     eax
fffff800`59942688 4803d9          add     rbx,rcx
fffff800`5994268b 23d0            and     edx,eax
fffff800`5994268d 44845b1a        test    byte ptr [rbx+1Ah],r11b
fffff800`59942691 0f8493020000    je      nt!MiInsertInSystemSpace+0x75a (fffff800`5994292a)  Branch

nt!MiInsertInSystemSpace+0x4c7:
fffff800`59942697 8b4320          mov     eax,dword ptr [rbx+20h]
fffff800`5994269a 4184c3          test    r11b,al
fffff800`5994269d 0f8587020000    jne     nt!MiInsertInSystemSpace+0x75a (fffff800`5994292a)  Branch

nt!MiInsertInSystemSpace+0x4d3:
fffff800`599426a3 488b4320        mov     rax,qword ptr [rbx+20h]
fffff800`599426a7 4923c2          and     rax,r10
fffff800`599426aa 493bc0          cmp     rax,r8
fffff800`599426ad 0f8577020000    jne     nt!MiInsertInSystemSpace+0x75a (fffff800`5994292a)  Branch

nt!MiInsertInSystemSpace+0x4e3:
fffff800`599426b3 44394b28        cmp     dword ptr [rbx+28h],r9d
fffff800`599426b7 0f856d020000    jne     nt!MiInsertInSystemSpace+0x75a (fffff800`5994292a)  Branch

nt!MiInsertInSystemSpace+0x4ed:
fffff800`599426bd 80631afe        and     byte ptr [rbx+1Ah],0FEh
fffff800`599426c1 488b4320        mov     rax,qword ptr [rbx+20h]
fffff800`599426c5 4885c0          test    rax,rax
fffff800`599426c8 0f845c020000    je      nt!MiInsertInSystemSpace+0x75a (fffff800`5994292a)  Branch

nt!MiInsertInSystemSpace+0x4fe:
fffff800`599426ce 4885db          test    rbx,rbx
fffff800`599426d1 0f8463020000    je      nt!MiInsertInSystemSpace+0x76a (fffff800`5994293a)  Branch

nt!MiInsertInSystemSpace+0x507:
fffff800`599426d7 0fb64320        movzx   eax,byte ptr [rbx+20h]
fffff800`599426db 0c02            or      al,2
fffff800`599426dd 884320          mov     byte ptr [rbx+20h],al
fffff800`599426e0 488b4320        mov     rax,qword ptr [rbx+20h]
fffff800`599426e4 48c1e83f        shr     rax,3Fh
fffff800`599426e8 84c0            test    al,al
fffff800`599426ea 0f8569020000    jne     nt!MiInsertInSystemSpace+0x789 (fffff800`59942959)  Branch

nt!MiInsertInSystemSpace+0x520:
fffff800`599426f0 897c2478        mov     dword ptr [rsp+78h],edi
fffff800`599426f4 8b4358          mov     eax,dword ptr [rbx+58h]
fffff800`599426f7 25ffff0100      and     eax,1FFFFh
fffff800`599426fc 89442478        mov     dword ptr [rsp+78h],eax
fffff800`59942700 8163580000feff  and     dword ptr [rbx+58h],0FFFE0000h
fffff800`59942707 806319fe        and     byte ptr [rbx+19h],0FEh
fffff800`5994270b 48897b20        mov     qword ptr [rbx+20h],rdi
fffff800`5994270f 48b8abaaaaaaaaaaaa2a mov rax,2AAAAAAAAAAAAAABh
fffff800`59942719 482bdd          sub     rbx,rbp
fffff800`5994271c 4881eb20030000  sub     rbx,320h
fffff800`59942723 48f7eb          imul    rbx
fffff800`59942726 48c1fa04        sar     rdx,4
fffff800`5994272a 488bc2          mov     rax,rdx
fffff800`5994272d 48c1e83f        shr     rax,3Fh
fffff800`59942731 4803d0          add     rdx,rax
fffff800`59942734 4585ed          test    r13d,r13d
fffff800`59942737 0f84f04c1800    je      nt!MiInsertInSystemSpace+0x18525d (fffff800`59ac742d)  Branch

nt!MiInsertInSystemSpace+0x56d:
fffff800`5994273d 0fb68518030000  movzx   eax,byte ptr [rbp+318h]
fffff800`59942744 0fabd0          bts     eax,edx
fffff800`59942747 888518030000    mov     byte ptr [rbp+318h],al

nt!MiInsertInSystemSpace+0x57d:
fffff800`5994274d fe8d1a030000    dec     byte ptr [rbp+31Ah]
fffff800`59942753 4c8d442478      lea     r8,[rsp+78h]
fffff800`59942758 498bd4          mov     rdx,r12
fffff800`5994275b 488bcd          mov     rcx,rbp
fffff800`5994275e e8ddb30700      call    nt!KiAbThreadRemoveBoosts (fffff800`599bdb40)
fffff800`59942763 668385e601000001 add     word ptr [rbp+1E6h],1
fffff800`5994276b 7510            jne     nt!MiInsertInSystemSpace+0x5ad (fffff800`5994277d)  Branch

nt!MiInsertInSystemSpace+0x59d:
fffff800`5994276d 488d8598000000  lea     rax,[rbp+98h]
fffff800`59942774 483900          cmp     qword ptr [rax],rax
fffff800`59942777 0f8514020000    jne     nt!MiInsertInSystemSpace+0x7c1 (fffff800`59942991)  Branch

nt!MiInsertInSystemSpace+0x5ad:
fffff800`5994277d 488b8c24a8010000 mov     rcx,qword ptr [rsp+1A8h]
fffff800`59942785 e876b40700      call    nt!KiLeaveGuardedRegionUnsafe (fffff800`599bdc00)
fffff800`5994278a 8b5c2450        mov     ebx,dword ptr [rsp+50h]

nt!MiInsertInSystemSpace+0x5be:
fffff800`5994278e 418b4738        mov     eax,dword ptr [r15+38h]
fffff800`59942792 488b4c2448      mov     rcx,qword ptr [rsp+48h]
fffff800`59942797 a801            test    al,1
fffff800`59942799 0f85b74c1800    jne     nt!MiInsertInSystemSpace+0x185286 (fffff800`59ac7456)  Branch

nt!MiInsertInSystemSpace+0x5cf:
fffff800`5994279f 83fb03          cmp     ebx,3
fffff800`599427a2 0f82bb4c1800    jb      nt!MiInsertInSystemSpace+0x185293 (fffff800`59ac7463)  Branch

nt!MiInsertInSystemSpace+0x5d8:
fffff800`599427a8 4885f6          test    rsi,rsi
fffff800`599427ab 7453            je      nt!MiInsertInSystemSpace+0x630 (fffff800`59942800)  Branch

nt!MiInsertInSystemSpace+0x5dd:
fffff800`599427ad 488bc7          mov     rax,rdi
fffff800`599427b0 49bb000011224488ffff mov r11,0FFFF884422110000h
fffff800`599427ba 48bbf80711224488ffff mov rbx,0FFFF8844221107F8h
fffff800`599427c4 48bd0000000000000080 mov rbp,8000000000000000h
fffff800`599427ce 6690            nop

nt!MiInsertInSystemSpace+0x600:
fffff800`599427d0 488b1519982c00  mov     rdx,qword ptr [nt!ZeroPte (fffff800`59c0bff0)]
fffff800`599427d7 4d8d04c6        lea     r8,[r14+rax*8]
fffff800`599427db 498bc3          mov     rax,r11
fffff800`599427de 4c3bc0          cmp     r8,rax
fffff800`599427e1 720c            jb      nt!MiInsertInSystemSpace+0x61f (fffff800`599427ef)  Branch

nt!MiInsertInSystemSpace+0x613:
fffff800`599427e3 488bc3          mov     rax,rbx
fffff800`599427e6 4c3bc0          cmp     r8,rax
fffff800`599427e9 0f865b4d1800    jbe     nt!MiInsertInSystemSpace+0x18537a (fffff800`59ac754a)  Branch

nt!MiInsertInSystemSpace+0x61f:
fffff800`599427ef 498910          mov     qword ptr [r8],rdx

nt!MiInsertInSystemSpace+0x622:
fffff800`599427f2 ffc7            inc     edi
fffff800`599427f4 8bc7            mov     eax,edi
fffff800`599427f6 483bc6          cmp     rax,rsi
fffff800`599427f9 72d5            jb      nt!MiInsertInSystemSpace+0x600 (fffff800`599427d0)  Branch

nt!MiInsertInSystemSpace+0x62b:
fffff800`599427fb 488b4c2448      mov     rcx,qword ptr [rsp+48h]

nt!MiInsertInSystemSpace+0x630:
fffff800`59942800 8b84248c000000  mov     eax,dword ptr [rsp+8Ch]
fffff800`59942807 4c8bc1          mov     r8,rcx
fffff800`5994280a 4c8b8c24b8010000 mov     r9,qword ptr [rsp+1B8h]
fffff800`59942812 498bce          mov     rcx,r14
fffff800`59942815 488bd6          mov     rdx,rsi
fffff800`59942818 89442420        mov     dword ptr [rsp+20h],eax
fffff800`5994281c e86f8d5d00      call    nt!MiAddMappedPtes (fffff800`59f1b590)
fffff800`59942821 8bf8            mov     edi,eax
fffff800`59942823 85c0            test    eax,eax
fffff800`59942825 0f887b4d1800    js      nt!MiInsertInSystemSpace+0x1853d6 (fffff800`59ac75a6)  Branch

nt!MiInsertInSystemSpace+0x65b:
fffff800`5994282b 488b8c24d0010000 mov     rcx,qword ptr [rsp+1D0h]
fffff800`59942833 488b442470      mov     rax,qword ptr [rsp+70h]
fffff800`59942838 488901          mov     qword ptr [rcx],rax

nt!MiInsertInSystemSpace+0x66b:
fffff800`5994283b 8bc7            mov     eax,edi

nt!MiInsertInSystemSpace+0x66d:
fffff800`5994283d 4881c458010000  add     rsp,158h
fffff800`59942844 415f            pop     r15
fffff800`59942846 415e            pop     r14
fffff800`59942848 415d            pop     r13
fffff800`5994284a 415c            pop     r12
fffff800`5994284c 5f              pop     rdi
fffff800`5994284d 5e              pop     rsi
fffff800`5994284e 5d              pop     rbp
fffff800`5994284f 5b              pop     rbx
fffff800`59942850 c3              ret

nt!MiInsertInSystemSpace+0x681:
fffff800`59942851 488b8db8000000  mov     rcx,qword ptr [rbp+0B8h]
fffff800`59942858 e873b30700      call    nt!MmGetSessionIdEx (fffff800`599bdbd0)
fffff800`5994285d 448bc8          mov     r9d,eax
fffff800`59942860 e9b9fdffff      jmp     nt!MiInsertInSystemSpace+0x44e (fffff800`5994261e)  Branch

nt!MiInsertInSystemSpace+0x695:
fffff800`59942865 41834f3802      or      dword ptr [r15+38h],2
fffff800`5994286a e904fcffff      jmp     nt!MiInsertInSystemSpace+0x2a3 (fffff800`59942473)  Branch

nt!MiInsertInSystemSpace+0x69f:
fffff800`5994286f 4032ed          xor     bpl,bpl
fffff800`59942872 e933fbffff      jmp     nt!MiInsertInSystemSpace+0x1da (fffff800`599423aa)  Branch

nt!MiInsertInSystemSpace+0x6a7:
fffff800`59942877 0fbae01a        bt      eax,1Ah
fffff800`5994287b 0f82eb000000    jb      nt!MiInsertInSystemSpace+0x79c (fffff800`5994296c)  Branch

nt!MiInsertInSystemSpace+0x6b1:
fffff800`59942881 498b03          mov     rax,qword ptr [r11]
fffff800`59942884 488b4030        mov     rax,qword ptr [rax+30h]
fffff800`59942888 4889442460      mov     qword ptr [rsp+60h],rax
fffff800`5994288d 4885c0          test    rax,rax
fffff800`59942890 741d            je      nt!MiInsertInSystemSpace+0x6df (fffff800`599428af)  Branch

nt!MiInsertInSystemSpace+0x6c2:
fffff800`59942892 488b4c2458      mov     rcx,qword ptr [rsp+58h]
fffff800`59942897 4533c0          xor     r8d,r8d
fffff800`5994289a 488bd0          mov     rdx,rax
fffff800`5994289d e81e920700      call    nt!MiChargeCommit (fffff800`599bbac0)
fffff800`599428a2 85c0            test    eax,eax
fffff800`599428a4 0f845d491800    je      nt!MiInsertInSystemSpace+0x185037 (fffff800`59ac7207)  Branch

nt!MiInsertInSystemSpace+0x6da:
fffff800`599428aa 4c8b5c2448      mov     r11,qword ptr [rsp+48h]

nt!MiInsertInSystemSpace+0x6df:
fffff800`599428af 83fb02          cmp     ebx,2
fffff800`599428b2 0f85c7fbffff    jne     nt!MiInsertInSystemSpace+0x2af (fffff800`5994247f)  Branch

nt!MiInsertInSystemSpace+0x6e8:
fffff800`599428b8 e959491800      jmp     nt!MiInsertInSystemSpace+0x185046 (fffff800`59ac7216)  Branch

nt!MiInsertInSystemSpace+0x6ed:
fffff800`599428bd c784248800000000010000 mov dword ptr [rsp+88h],100h
fffff800`599428c8 e83f0ffaff      call    nt!MiGetSessionVm (fffff800`598e380c)
fffff800`599428cd 48898424a0000000 mov     qword ptr [rsp+0A0h],rax
fffff800`599428d5 41bc02000000    mov     r12d,2
fffff800`599428db 480540f4ffff    add     rax,0FFFFFFFFFFFFF440h
fffff800`599428e1 48898424a8000000 mov     qword ptr [rsp+0A8h],rax
fffff800`599428e9 4805c81f0000    add     rax,1FC8h
fffff800`599428ef 4889442468      mov     qword ptr [rsp+68h],rax
fffff800`599428f4 65488b042588010000 mov   rax,qword ptr gs:[188h]
fffff800`599428fd 488b88b8000000  mov     rcx,qword ptr [rax+0B8h]
fffff800`59942904 e8c7b20700      call    nt!MmGetSessionIdEx (fffff800`599bdbd0)
fffff800`59942909 448b6c2450      mov     r13d,dword ptr [rsp+50h]
fffff800`5994290e 8984248c000000  mov     dword ptr [rsp+8Ch],eax
fffff800`59942915 e9f7f9ffff      jmp     nt!MiInsertInSystemSpace+0x141 (fffff800`59942311)  Branch

nt!MiInsertInSystemSpace+0x74a:
fffff800`5994291a 488b8424a8000000 mov     rax,qword ptr [rsp+0A8h]
fffff800`59942922 8b4008          mov     eax,dword ptr [rax+8]
fffff800`59942925 e9bdfbffff      jmp     nt!MiInsertInSystemSpace+0x317 (fffff800`599424e7)  Branch

nt!MiInsertInSystemSpace+0x75a:
fffff800`5994292a 0fbdca          bsr     ecx,edx
fffff800`5994292d 898c2498000000  mov     dword ptr [rsp+98h],ecx
fffff800`59942934 0f8538fdffff    jne     nt!MiInsertInSystemSpace+0x4a2 (fffff800`59942672)  Branch

nt!MiInsertInSystemSpace+0x76a:
fffff800`5994293a 8b4578          mov     eax,dword ptr [rbp+78h]
fffff800`5994293d 0fbae010        bt      eax,10h
fffff800`59942941 0f8206feffff    jb      nt!MiInsertInSystemSpace+0x57d (fffff800`5994274d)  Branch

nt!MiInsertInSystemSpace+0x777:
fffff800`59942947 e9f44a1800      jmp     nt!MiInsertInSystemSpace+0x185270 (fffff800`59ac7440)  Branch

nt!MiInsertInSystemSpace+0x77c:
fffff800`5994294c 498bcc          mov     rcx,r12
fffff800`5994294f e8ecc7f7ff      call    nt!ExfTryToWakePushLock (fffff800`598bf140)
fffff800`59942954 e9a1fcffff      jmp     nt!MiInsertInSystemSpace+0x42a (fffff800`599425fa)  Branch

nt!MiInsertInSystemSpace+0x789:
fffff800`59942959 488bcb          mov     rcx,rbx
fffff800`5994295c e89f7cfbff      call    nt!KiAbEntryRemoveFromTree (fffff800`598fa600)
fffff800`59942961 41bb01000000    mov     r11d,1
fffff800`59942967 e984fdffff      jmp     nt!MiInsertInSystemSpace+0x520 (fffff800`599426f0)  Branch

nt!MiInsertInSystemSpace+0x79c:
fffff800`5994296c b8ffffffff      mov     eax,0FFFFFFFFh
fffff800`59942971 498bcb          mov     rcx,r11
fffff800`59942974 8bd0            mov     edx,eax
fffff800`59942976 89442440        mov     dword ptr [rsp+40h],eax
fffff800`5994297a e831215900      call    nt!MiCreatePerSessionProtos (fffff800`59ed4ab0)
fffff800`5994297f 85c0            test    eax,eax
fffff800`59942981 0f8859481800    js      nt!MiInsertInSystemSpace+0x185010 (fffff800`59ac71e0)  Branch

nt!MiInsertInSystemSpace+0x7b7:
fffff800`59942987 4c8b5c2448      mov     r11,qword ptr [rsp+48h]
fffff800`5994298c e9f0feffff      jmp     nt!MiInsertInSystemSpace+0x6b1 (fffff800`59942881)  Branch

nt!MiInsertInSystemSpace+0x7c1:
fffff800`59942991 e84aeef9ff      call    nt!KiCheckForKernelApcDelivery (fffff800`598e17e0)
fffff800`59942996 e9e2fdffff      jmp     nt!MiInsertInSystemSpace+0x5ad (fffff800`5994277d)  Branch

nt!MiInsertInSystemSpace+0x184f4e:
fffff800`59ac711e bb1f0000c0      mov     ebx,0C000001Fh
fffff800`59ac7123 4032ed          xor     bpl,bpl
fffff800`59ac7126 e93a010000      jmp     nt!MiInsertInSystemSpace+0x185095 (fffff800`59ac7265)  Branch

nt!MiInsertInSystemSpace+0x184f5b:
fffff800`59ac712b bb170000c0      mov     ebx,0C0000017h
fffff800`59ac7130 4c8d0d010a2200  lea     r9,[nt!MiState+0x2178 (fffff800`59ce7b38)]
fffff800`59ac7137 4c8bc6          mov     r8,rsi
fffff800`59ac713a 4032ed          xor     bpl,bpl
fffff800`59ac713d 4c8bde          mov     r11,rsi
fffff800`59ac7140 e916010000      jmp     nt!MiInsertInSystemSpace+0x18508b (fffff800`59ac725b)  Branch

nt!MiInsertInSystemSpace+0x184f75:
fffff800`59ac7145 488b8c2480000000 mov     rcx,qword ptr [rsp+80h]
fffff800`59ac714d 458bc5          mov     r8d,r13d
fffff800`59ac7150 ba09000000      mov     edx,9
fffff800`59ac7155 e81a3cf6ff      call    nt!MiGetPageTablesForLargeMap (fffff800`59a2ad74)
fffff800`59ac715a 4889442470      mov     qword ptr [rsp+70h],rax
fffff800`59ac715f 4885c0          test    rax,rax
fffff800`59ac7162 750d            jne     nt!MiInsertInSystemSpace+0x184fa1 (fffff800`59ac7171)  Branch

nt!MiInsertInSystemSpace+0x184f94:
fffff800`59ac7164 bb9a0000c0      mov     ebx,0C000009Ah
fffff800`59ac7169 4c8bc7          mov     r8,rdi
fffff800`59ac716c e9e0000000      jmp     nt!MiInsertInSystemSpace+0x185081 (fffff800`59ac7251)  Branch

nt!MiInsertInSystemSpace+0x184fa1:
fffff800`59ac7171 4c8bf0          mov     r14,rax
fffff800`59ac7174 48b8f8ffffff7f000000 mov rax,7FFFFFFFF8h
fffff800`59ac717e 49c1ee09        shr     r14,9
fffff800`59ac7182 4c23f0          and     r14,rax
fffff800`59ac7185 48b8000000000088ffff mov rax,0FFFF880000000000h
fffff800`59ac718f 488bc0          mov     rax,rax
fffff800`59ac7192 4c03f0          add     r14,rax
fffff800`59ac7195 e951b2e7ff      jmp     nt!MiInsertInSystemSpace+0x21b (fffff800`599423eb)  Branch

nt!MiInsertInSystemSpace+0x184fca:
fffff800`59ac719a 4c8bc7          mov     r8,rdi
fffff800`59ac719d 4032ed          xor     bpl,bpl
fffff800`59ac71a0 e9ac000000      jmp     nt!MiInsertInSystemSpace+0x185081 (fffff800`59ac7251)  Branch

nt!MiInsertInSystemSpace+0x184fd5:
fffff800`59ac71a5 bb9a0000c0      mov     ebx,0C000009Ah
fffff800`59ac71aa 4c8bc7          mov     r8,rdi
fffff800`59ac71ad e99f000000      jmp     nt!MiInsertInSystemSpace+0x185081 (fffff800`59ac7251)  Branch

nt!MiInsertInSystemSpace+0x184fe2:
fffff800`59ac71b2 bb9a0000c0      mov     ebx,0C000009Ah
fffff800`59ac71b7 4c8bc7          mov     r8,rdi
fffff800`59ac71ba e992000000      jmp     nt!MiInsertInSystemSpace+0x185081 (fffff800`59ac7251)  Branch

nt!MiInsertInSystemSpace+0x184fef:
fffff800`59ac71bf bb0b0600c0      mov     ebx,0C000060Bh
fffff800`59ac71c4 4c8bc7          mov     r8,rdi
fffff800`59ac71c7 e985000000      jmp     nt!MiInsertInSystemSpace+0x185081 (fffff800`59ac7251)  Branch

nt!MiInsertInSystemSpace+0x184ffc:
fffff800`59ac71cc 41834f3804      or      dword ptr [r15+38h],4
fffff800`59ac71d1 e97ab2e7ff      jmp     nt!MiInsertInSystemSpace+0x280 (fffff800`59942450)  Branch

nt!MiInsertInSystemSpace+0x185006:
fffff800`59ac71d6 41834f3801      or      dword ptr [r15+38h],1
fffff800`59ac71db e985b2e7ff      jmp     nt!MiInsertInSystemSpace+0x295 (fffff800`59942465)  Branch

nt!MiInsertInSystemSpace+0x185010:
fffff800`59ac71e0 0fb6ac24a8010000 movzx   ebp,byte ptr [rsp+1A8h]
fffff800`59ac71e8 41baffff0700    mov     r10d,7FFFFh
fffff800`59ac71ee 4c8b4c2468      mov     r9,qword ptr [rsp+68h]
fffff800`59ac71f3 bb170000c0      mov     ebx,0C0000017h
fffff800`59ac71f8 4c8b5c2458      mov     r11,qword ptr [rsp+58h]
fffff800`59ac71fd 4c8bc7          mov     r8,rdi
fffff800`59ac7200 4489542440      mov     dword ptr [rsp+40h],r10d
fffff800`59ac7205 eb59            jmp     nt!MiInsertInSystemSpace+0x185090 (fffff800`59ac7260)  Branch

nt!MiInsertInSystemSpace+0x185037:
fffff800`59ac7207 4c8bc7          mov     r8,rdi
fffff800`59ac720a 48897c2460      mov     qword ptr [rsp+60h],rdi
fffff800`59ac720f bb2d0100c0      mov     ebx,0C000012Dh
fffff800`59ac7214 eb33            jmp     nt!MiInsertInSystemSpace+0x185079 (fffff800`59ac7249)  Branch

nt!MiInsertInSystemSpace+0x185046:
fffff800`59ac7216 8b942488000000  mov     edx,dword ptr [rsp+88h]
fffff800`59ac721d 498d8380000000  lea     rax,[r11+80h]
fffff800`59ac7224 83ca08          or      edx,8
fffff800`59ac7227 4889842490000000 mov     qword ptr [rsp+90h],rax
fffff800`59ac722f 488bc8          mov     rcx,rax
fffff800`59ac7232 41b011          mov     r8b,11h
fffff800`59ac7235 e86612ebff      call    nt!MiReferenceActiveSubsection (fffff800`599784a0)
fffff800`59ac723a 8bd8            mov     ebx,eax
fffff800`59ac723c 85c0            test    eax,eax
fffff800`59ac723e 0f893bb2e7ff    jns     nt!MiInsertInSystemSpace+0x2af (fffff800`5994247f)  Branch

nt!MiInsertInSystemSpace+0x185074:
fffff800`59ac7244 4c8b442460      mov     r8,qword ptr [rsp+60h]

nt!MiInsertInSystemSpace+0x185079:
fffff800`59ac7249 0fb6ac24a8010000 movzx   ebp,byte ptr [rsp+1A8h]

nt!MiInsertInSystemSpace+0x185081:
fffff800`59ac7251 4c8b4c2468      mov     r9,qword ptr [rsp+68h]
fffff800`59ac7256 4c8b5c2458      mov     r11,qword ptr [rsp+58h]

nt!MiInsertInSystemSpace+0x18508b:
fffff800`59ac725b 448b542440      mov     r10d,dword ptr [rsp+40h]

nt!MiInsertInSystemSpace+0x185090:
fffff800`59ac7260 488b4c2448      mov     rcx,qword ptr [rsp+48h]

nt!MiInsertInSystemSpace+0x185095:
fffff800`59ac7265 488b8424a0010000 mov     rax,qword ptr [rsp+1A0h]
fffff800`59ac726d ff401c          inc     dword ptr [rax+1Ch]
fffff800`59ac7270 4d85f6          test    r14,r14
fffff800`59ac7273 744b            je      nt!MiInsertInSystemSpace+0x1850f0 (fffff800`59ac72c0)  Branch

nt!MiInsertInSystemSpace+0x1850a5:
fffff800`59ac7275 4183fd03        cmp     r13d,3
fffff800`59ac7279 731e            jae     nt!MiInsertInSystemSpace+0x1850c9 (fffff800`59ac7299)  Branch

nt!MiInsertInSystemSpace+0x1850ab:
fffff800`59ac727b 488b942480000000 mov     rdx,qword ptr [rsp+80h]
fffff800`59ac7283 41b809000000    mov     r8d,9
fffff800`59ac7289 488b4c2470      mov     rcx,qword ptr [rsp+70h]
fffff800`59ac728e 48c1e20c        shl     rdx,0Ch
fffff800`59ac7292 e8698e0a00      call    nt!MiUnmapLargePages (fffff800`59b70100)
fffff800`59ac7297 eb13            jmp     nt!MiInsertInSystemSpace+0x1850dc (fffff800`59ac72ac)  Branch

nt!MiInsertInSystemSpace+0x1850c9:
fffff800`59ac7299 448b842480000000 mov     r8d,dword ptr [rsp+80h]
fffff800`59ac72a1 498bd6          mov     rdx,r14
fffff800`59ac72a4 498bc9          mov     rcx,r9
fffff800`59ac72a7 e824e1edff      call    nt!MiReleasePtes (fffff800`599a53d0)

nt!MiInsertInSystemSpace+0x1850dc:
fffff800`59ac72ac 488b4c2448      mov     rcx,qword ptr [rsp+48h]
fffff800`59ac72b1 4c8b5c2458      mov     r11,qword ptr [rsp+58h]
fffff800`59ac72b6 448b542440      mov     r10d,dword ptr [rsp+40h]
fffff800`59ac72bb 4c8b442460      mov     r8,qword ptr [rsp+60h]

nt!MiInsertInSystemSpace+0x1850f0:
fffff800`59ac72c0 4080fd01        cmp     bpl,1
fffff800`59ac72c4 753c            jne     nt!MiInsertInSystemSpace+0x185132 (fffff800`59ac7302)  Branch

nt!MiInsertInSystemSpace+0x1850f6:
fffff800`59ac72c6 488b9424b8010000 mov     rdx,qword ptr [rsp+1B8h]
fffff800`59ac72ce 8bc7            mov     eax,edi
fffff800`59ac72d0 4183fc02        cmp     r12d,2
fffff800`59ac72d4 4c8bc6          mov     r8,rsi
fffff800`59ac72d7 0f95c0          setne   al
fffff800`59ac72da 4183fd03        cmp     r13d,3
fffff800`59ac72de 89442420        mov     dword ptr [rsp+20h],eax
fffff800`59ac72e2 400f92c7        setb    dil
fffff800`59ac72e6 448bcf          mov     r9d,edi
fffff800`59ac72e9 e8467c0a00      call    nt!MiDereferenceDataSubsections (fffff800`59b6ef34)
fffff800`59ac72ee 4c8b442460      mov     r8,qword ptr [rsp+60h]
fffff800`59ac72f3 448b542440      mov     r10d,dword ptr [rsp+40h]
fffff800`59ac72f8 4c8b5c2458      mov     r11,qword ptr [rsp+58h]
fffff800`59ac72fd 488b4c2448      mov     rcx,qword ptr [rsp+48h]

nt!MiInsertInSystemSpace+0x185132:
fffff800`59ac7302 4181faffff0700  cmp     r10d,7FFFFh
fffff800`59ac7309 7412            je      nt!MiInsertInSystemSpace+0x18514d (fffff800`59ac731d)  Branch

nt!MiInsertInSystemSpace+0x18513b:
fffff800`59ac730b 418bd2          mov     edx,r10d
fffff800`59ac730e e885d64000      call    nt!MiDereferencePerSessionProtos (fffff800`59ed4998)
fffff800`59ac7313 4c8b442460      mov     r8,qword ptr [rsp+60h]
fffff800`59ac7318 4c8b5c2458      mov     r11,qword ptr [rsp+58h]

nt!MiInsertInSystemSpace+0x18514d:
fffff800`59ac731d 4d85c0          test    r8,r8
fffff800`59ac7320 740b            je      nt!MiInsertInSystemSpace+0x18515d (fffff800`59ac732d)  Branch

nt!MiInsertInSystemSpace+0x185152:
fffff800`59ac7322 498bd0          mov     rdx,r8
fffff800`59ac7325 498bcb          mov     rcx,r11
fffff800`59ac7328 e803e1e8ff      call    nt!MiReturnCommit (fffff800`59955430)

nt!MiInsertInSystemSpace+0x18515d:
fffff800`59ac732d 4d85ff          test    r15,r15
fffff800`59ac7330 740a            je      nt!MiInsertInSystemSpace+0x18516c (fffff800`59ac733c)  Branch

nt!MiInsertInSystemSpace+0x185162:
fffff800`59ac7332 33d2            xor     edx,edx
fffff800`59ac7334 498bcf          mov     rcx,r15
fffff800`59ac7337 e844f91200      call    nt!ExFreePoolWithTag (fffff800`59bf6c80)

nt!MiInsertInSystemSpace+0x18516c:
fffff800`59ac733c 8bc3            mov     eax,ebx
fffff800`59ac733e e9fab4e7ff      jmp     nt!MiInsertInSystemSpace+0x66d (fffff800`5994283d)  Branch

nt!MiInsertInSystemSpace+0x185173:
fffff800`59ac7343 488b4c2448      mov     rcx,qword ptr [rsp+48h]
fffff800`59ac7348 f7413800040000  test    dword ptr [rcx+38h],400h
fffff800`59ac734f 0f85d3000000    jne     nt!MiInsertInSystemSpace+0x185258 (fffff800`59ac7428)  Branch

nt!MiInsertInSystemSpace+0x185185:
fffff800`59ac7355 498bc4          mov     rax,r12
fffff800`59ac7358 48c1e81e        shr     rax,1Eh
fffff800`59ac735c 0fb6e8          movzx   ebp,al
fffff800`59ac735f 488d05aaeb2100  lea     rax,[nt!MiState+0x550 (fffff800`59ce5f10)]
fffff800`59ac7366 48c1e504        shl     rbp,4
fffff800`59ac736a 4803e8          add     rbp,rax
fffff800`59ac736d 488d4d0c        lea     rcx,[rbp+0Ch]
fffff800`59ac7371 e8fa17eaff      call    nt!ExAcquireSpinLockExclusive (fffff800`59968b70)
fffff800`59ac7376 ff4508          inc     dword ptr [rbp+8]
fffff800`59ac7379 4532c0          xor     r8b,r8b
fffff800`59ac737c 488b5500        mov     rdx,qword ptr [rbp]
fffff800`59ac7380 440fb6e0        movzx   r12d,al
fffff800`59ac7384 4885d2          test    rdx,rdx
fffff800`59ac7387 742c            je      nt!MiInsertInSystemSpace+0x1851e5 (fffff800`59ac73b5)  Branch

nt!MiInsertInSystemSpace+0x1851b9:
fffff800`59ac7389 4c8b4258        mov     r8,qword ptr [rdx+58h]
fffff800`59ac738d 488b4a20        mov     rcx,qword ptr [rdx+20h]
fffff800`59ac7391 4981e000f0ffff  and     r8,0FFFFFFFFFFFFF000h
fffff800`59ac7398 488b442470      mov     rax,qword ptr [rsp+70h]
fffff800`59ac739d 4903c8          add     rcx,r8
fffff800`59ac73a0 483bc1          cmp     rax,rcx
fffff800`59ac73a3 736d            jae     nt!MiInsertInSystemSpace+0x185242 (fffff800`59ac7412)  Branch

nt!MiInsertInSystemSpace+0x1851d5:
fffff800`59ac73a5 493bc0          cmp     rax,r8
fffff800`59ac73a8 7368            jae     nt!MiInsertInSystemSpace+0x185242 (fffff800`59ac7412)  Branch

nt!MiInsertInSystemSpace+0x1851da:
fffff800`59ac73aa 488b02          mov     rax,qword ptr [rdx]
fffff800`59ac73ad 4885c0          test    rax,rax
fffff800`59ac73b0 756e            jne     nt!MiInsertInSystemSpace+0x185250 (fffff800`59ac7420)  Branch

nt!MiInsertInSystemSpace+0x1851e2:
fffff800`59ac73b2 4532c0          xor     r8b,r8b

nt!MiInsertInSystemSpace+0x1851e5:
fffff800`59ac73b5 4d8bcf          mov     r9,r15
fffff800`59ac73b8 488bcd          mov     rcx,rbp
fffff800`59ac73bb e83002ebff      call    nt!RtlAvlInsertNodeEx (fffff800`599775f0)
fffff800`59ac73c0 488d4d0c        lea     rcx,[rbp+0Ch]
fffff800`59ac73c4 e82719eaff      call    nt!ExReleaseSpinLockExclusiveFromDpcLevel (fffff800`59968cf0)
fffff800`59ac73c9 8b0525813200    mov     eax,dword ptr [nt!KiIrqlFlags (fffff800`59def4f4)]
fffff800`59ac73cf 85c0            test    eax,eax
fffff800`59ac73d1 7432            je      nt!MiInsertInSystemSpace+0x185235 (fffff800`59ac7405)  Branch

nt!MiInsertInSystemSpace+0x185203:
fffff800`59ac73d3 a801            test    al,1
fffff800`59ac73d5 742e            je      nt!MiInsertInSystemSpace+0x185235 (fffff800`59ac7405)  Branch

nt!MiInsertInSystemSpace+0x185207:
fffff800`59ac73d7 440f20c0        mov     rax,cr8
fffff800`59ac73db 3c02            cmp     al,2
fffff800`59ac73dd 7226            jb      nt!MiInsertInSystemSpace+0x185235 (fffff800`59ac7405)  Branch

nt!MiInsertInSystemSpace+0x18520f:
fffff800`59ac73df 4180fc02        cmp     r12b,2
fffff800`59ac73e3 7320            jae     nt!MiInsertInSystemSpace+0x185235 (fffff800`59ac7405)  Branch

nt!MiInsertInSystemSpace+0x185215:
fffff800`59ac73e5 65488b0c2520000000 mov   rcx,qword ptr gs:[20h]
fffff800`59ac73ee 488b81b8610000  mov     rax,qword ptr [rcx+61B8h]
fffff800`59ac73f5 f08120fffffeff  lock and dword ptr [rax],0FFFEFFFFh
fffff800`59ac73fc e87b1ff9ff      call    nt!KiRemoveSystemWorkPriorityKick (fffff800`59a5937c)
fffff800`59ac7401 8b5c2450        mov     ebx,dword ptr [rsp+50h]

nt!MiInsertInSystemSpace+0x185235:
fffff800`59ac7405 410fb6c4        movzx   eax,r12b
fffff800`59ac7409 440f22c0        mov     cr8,rax
fffff800`59ac740d e97cb3e7ff      jmp     nt!MiInsertInSystemSpace+0x5be (fffff800`5994278e)  Branch

nt!MiInsertInSystemSpace+0x185242:
fffff800`59ac7412 488b4208        mov     rax,qword ptr [rdx+8]
fffff800`59ac7416 4885c0          test    rax,rax
fffff800`59ac7419 7505            jne     nt!MiInsertInSystemSpace+0x185250 (fffff800`59ac7420)  Branch

nt!MiInsertInSystemSpace+0x18524b:
fffff800`59ac741b 41b001          mov     r8b,1
fffff800`59ac741e eb95            jmp     nt!MiInsertInSystemSpace+0x1851e5 (fffff800`59ac73b5)  Branch

nt!MiInsertInSystemSpace+0x185250:
fffff800`59ac7420 488bd0          mov     rdx,rax
fffff800`59ac7423 e961ffffff      jmp     nt!MiInsertInSystemSpace+0x1851b9 (fffff800`59ac7389)  Branch

nt!MiInsertInSystemSpace+0x185258:
fffff800`59ac7428 e9e7b0e7ff      jmp     nt!MiInsertInSystemSpace+0x344 (fffff800`59942514)  Branch

nt!MiInsertInSystemSpace+0x18525d:
fffff800`59ac742d 8bca            mov     ecx,edx
fffff800`59ac742f 418bc3          mov     eax,r11d
fffff800`59ac7432 d2e0            shl     al,cl
fffff800`59ac7434 f008858e050000  lock or byte ptr [rbp+58Eh],al
fffff800`59ac743b e90db3e7ff      jmp     nt!MiInsertInSystemSpace+0x57d (fffff800`5994274d)  Branch

nt!MiInsertInSystemSpace+0x185270:
fffff800`59ac7440 4d8bc4          mov     r8,r12
fffff800`59ac7443 48897c2420      mov     qword ptr [rsp+20h],rdi
fffff800`59ac7448 488bd5          mov     rdx,rbp
fffff800`59ac744b b962010000      mov     ecx,162h
fffff800`59ac7450 e88b81f9ff      call    nt!KeBugCheckEx (fffff800`59a5f5e0)
fffff800`59ac7455 cc              int     3

nt!MiInsertInSystemSpace+0x185286:
fffff800`59ac7456 f0ff415c        lock inc dword ptr [rcx+5Ch]
fffff800`59ac745a 8b5c2450        mov     ebx,dword ptr [rsp+50h]
fffff800`59ac745e e93cb3e7ff      jmp     nt!MiInsertInSystemSpace+0x5cf (fffff800`5994279f)  Branch

nt!MiInsertInSystemSpace+0x185293:
fffff800`59ac7463 488d2d1e421400  lea     rbp,[nt!MiLargePageSizes (fffff800`59c0b688)]
fffff800`59ac746a 4c8b842490000000 mov     r8,qword ptr [rsp+90h]
fffff800`59ac7472 4c8be7          mov     r12,rdi
fffff800`59ac7475 4c8b7c2470      mov     r15,qword ptr [rsp+70h]
fffff800`59ac747a 8bc3            mov     eax,ebx
fffff800`59ac747c 498b5008        mov     rdx,qword ptr [r8+8]
fffff800`59ac7480 488b6cc500      mov     rbp,qword ptr [rbp+rax*8]
fffff800`59ac7485 488b8424b0000000 mov     rax,qword ptr [rsp+0B0h]
fffff800`59ac748d 488d34c2        lea     rsi,[rdx+rax*8]
fffff800`59ac7491 418b402c        mov     eax,dword ptr [r8+2Ch]
fffff800`59ac7495 4c8d2cc2        lea     r13,[rdx+rax*8]
fffff800`59ac7499 4839bc2480000000 cmp     qword ptr [rsp+80h],rdi
fffff800`59ac74a1 0f8684b3e7ff    jbe     nt!MiInsertInSystemSpace+0x65b (fffff800`5994282b)  Branch

nt!MiInsertInSystemSpace+0x1852d7:
fffff800`59ac74a7 b903000000      mov     ecx,3
fffff800`59ac74ac e8b3cbe8ff      call    nt!MiGetAnyMultiplexedVm (fffff800`59954064)
fffff800`59ac74b1 4c8bf5          mov     r14,rbp
fffff800`59ac74b4 488bf8          mov     rdi,rax
fffff800`59ac74b7 49c1e60c        shl     r14,0Ch
fffff800`59ac74bb 49b9ffffffff0f000000 mov r9,0FFFFFFFFFh

nt!MiInsertInSystemSpace+0x1852f5:
fffff800`59ac74c5 493bf5          cmp     rsi,r13
fffff800`59ac74c8 7518            jne     nt!MiInsertInSystemSpace+0x185312 (fffff800`59ac74e2)  Branch

nt!MiInsertInSystemSpace+0x1852fa:
fffff800`59ac74ca 4d8b4010        mov     r8,qword ptr [r8+10h]
fffff800`59ac74ce 4c89842490000000 mov     qword ptr [rsp+90h],r8
fffff800`59ac74d6 498b7008        mov     rsi,qword ptr [r8+8]
fffff800`59ac74da 418b402c        mov     eax,dword ptr [r8+2Ch]
fffff800`59ac74de 4c8d2cc6        lea     r13,[rsi+rax*8]

nt!MiInsertInSystemSpace+0x185312:
fffff800`59ac74e2 488bce          mov     rcx,rsi
fffff800`59ac74e5 e87689eeff      call    nt!MI_READ_PTE_LOCK_FREE (fffff800`599afe60)
fffff800`59ac74ea 48c1e80c        shr     rax,0Ch
fffff800`59ac74ee 498bd7          mov     rdx,r15
fffff800`59ac74f1 4923c1          and     rax,r9
fffff800`59ac74f4 c744243001000000 mov     dword ptr [rsp+30h],1
fffff800`59ac74fc 4c8bc0          mov     r8,rax
fffff800`59ac74ff c744242804000000 mov     dword ptr [rsp+28h],4
fffff800`59ac7507 4c8bcd          mov     r9,rbp
fffff800`59ac750a 895c2420        mov     dword ptr [rsp+20h],ebx
fffff800`59ac750e 488bcf          mov     rcx,rdi
fffff800`59ac7511 e89a35f6ff      call    nt!MiMapWithLargePages (fffff800`59a2aab0)
fffff800`59ac7516 4c8b842490000000 mov     r8,qword ptr [rsp+90h]
fffff800`59ac751e 488d04ed00000000 lea     rax,[rbp*8]
fffff800`59ac7526 4803f0          add     rsi,rax
fffff800`59ac7529 4d03fe          add     r15,r14
fffff800`59ac752c 4c03e5          add     r12,rbp
fffff800`59ac752f 49b9ffffffff0f000000 mov r9,0FFFFFFFFFh
fffff800`59ac7539 4c3ba42480000000 cmp     r12,qword ptr [rsp+80h]
fffff800`59ac7541 7282            jb      nt!MiInsertInSystemSpace+0x1852f5 (fffff800`59ac74c5)  Branch

nt!MiInsertInSystemSpace+0x185373:
fffff800`59ac7543 33ff            xor     edi,edi
fffff800`59ac7545 e9e1b2e7ff      jmp     nt!MiInsertInSystemSpace+0x65b (fffff800`5994282b)  Branch

nt!MiInsertInSystemSpace+0x18537a:
fffff800`59ac754a e8b1dee5ff      call    nt!MiPteHasShadow (fffff800`59925400)
fffff800`59ac754f 85c0            test    eax,eax
fffff800`59ac7551 7422            je      nt!MiInsertInSystemSpace+0x1853a5 (fffff800`59ac7575)  Branch

nt!MiInsertInSystemSpace+0x185383:
fffff800`59ac7553 803dd3fb210000  cmp     byte ptr [nt!MiState+0x176d (fffff800`59ce712d)],0
fffff800`59ac755a 7508            jne     nt!MiInsertInSystemSpace+0x185394 (fffff800`59ac7564)  Branch

nt!MiInsertInSystemSpace+0x18538c:
fffff800`59ac755c f6c201          test    dl,1
fffff800`59ac755f 7403            je      nt!MiInsertInSystemSpace+0x185394 (fffff800`59ac7564)  Branch

nt!MiInsertInSystemSpace+0x185391:
fffff800`59ac7561 480bd5          or      rdx,rbp

nt!MiInsertInSystemSpace+0x185394:
fffff800`59ac7564 498bc8          mov     rcx,r8
fffff800`59ac7567 498910          mov     qword ptr [r8],rdx
fffff800`59ac756a e831dee5ff      call    nt!MiWritePteShadow (fffff800`599253a0)
fffff800`59ac756f 90              nop
fffff800`59ac7570 e97db2e7ff      jmp     nt!MiInsertInSystemSpace+0x622 (fffff800`599427f2)  Branch

nt!MiInsertInSystemSpace+0x1853a5:
fffff800`59ac7575 65488b042588010000 mov   rax,qword ptr gs:[188h]
fffff800`59ac757e 488b88b8000000  mov     rcx,qword ptr [rax+0B8h]
fffff800`59ac7585 f781cc06000000100000 test dword ptr [rcx+6CCh],1000h
fffff800`59ac758f 0f845ab2e7ff    je      nt!MiInsertInSystemSpace+0x61f (fffff800`599427ef)  Branch

nt!MiInsertInSystemSpace+0x1853c5:
fffff800`59ac7595 f6c201          test    dl,1
fffff800`59ac7598 0f8451b2e7ff    je      nt!MiInsertInSystemSpace+0x61f (fffff800`599427ef)  Branch

nt!MiInsertInSystemSpace+0x1853ce:
fffff800`59ac759e 480bd5          or      rdx,rbp
fffff800`59ac75a1 e949b2e7ff      jmp     nt!MiInsertInSystemSpace+0x61f (fffff800`599427ef)  Branch

nt!MiInsertInSystemSpace+0x1853d6:
fffff800`59ac75a6 488b8424a0010000 mov     rax,qword ptr [rsp+1A0h]
fffff800`59ac75ae 4533c0          xor     r8d,r8d
fffff800`59ac75b1 488b542470      mov     rdx,qword ptr [rsp+70h]
fffff800`59ac75b6 488bc8          mov     rcx,rax
fffff800`59ac75b9 ff401c          inc     dword ptr [rax+1Ch]
fffff800`59ac75bc e8cbaee8ff      call    nt!MiRemoveFromSystemSpace (fffff800`5995248c)
fffff800`59ac75c1 90              nop
fffff800`59ac75c2 e974b2e7ff      jmp     nt!MiInsertInSystemSpace+0x66b (fffff800`5994283b)  Branch
